<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-material.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"example.com",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!1,show_result:!1,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!1},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!1,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="1.创建新的虚拟机 一、创建虚拟机1. 2. 3.官网下载iso文件          6.随变取（maduit 密码：123）  7. 8.自定义文件  9.内存至少需要4GB 4核也够了   10.自动初始化   11.初始化完成，点击bigdata用户       然后虚拟机的安装就完成了 emmm ，但是书上说要 创建一个hadoop用户1sudo useradd -m hadoop -s"><meta property="og:type" content="article"><meta property="og:title" content="电影推荐系统"><meta property="og:url" content="http://example.com/2023/05/26/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/index.html"><meta property="og:site_name" content="睡觉万岁"><meta property="og:description" content="1.创建新的虚拟机 一、创建虚拟机1. 2. 3.官网下载iso文件          6.随变取（maduit 密码：123）  7. 8.自定义文件  9.内存至少需要4GB 4核也够了   10.自动初始化   11.初始化完成，点击bigdata用户       然后虚拟机的安装就完成了 emmm ，但是书上说要 创建一个hadoop用户1sudo useradd -m hadoop -s"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/1.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/2.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/3.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/4.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/5.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/6.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/7.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/8.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/9.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/10.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/11.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/12.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/13.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/78.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/14.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/16.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/17.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/18.png"><meta property="og:image" content="c:\Users\GJQ\AppData\Roaming\Typora\typora-user-images\1685171531582.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/34.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/35.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/36.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/37.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/23.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/25.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/24.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/26.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/19.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/21.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/27.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/28.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/29.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/30.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/31.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/32.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/33.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/39.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/40.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/41.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/42.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/43.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/44.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/45.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/46.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/44.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/44.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/47.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/48.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/49.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/50.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/51.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/52.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/53.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/54.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/55.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/56.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/57.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/58.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/59.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/60.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/61.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/62.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/63.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/64.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/65.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/66.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/67.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/68.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/69.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/70.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/71.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/79.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/80.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/81.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/82.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/83.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/84.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/85.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/86.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/87.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/88.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/89.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/90.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/91.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/92.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/93.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/94.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/95.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/96.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/97.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/98.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/99.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/100.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/101.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/102.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/103.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/104.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/105.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/106.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/107.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/108.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/109.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/110.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/111.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/112.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/113.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/114.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/115.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/116.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/117.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/118.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/119.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/120.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/121.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/122.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/123.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/124.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/125.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/126.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/127.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/129.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/128.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/130.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/131.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/132.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/133.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/134.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/135.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/136.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/137.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/138.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/139.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/140.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/141.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/142.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/143.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/144.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/145.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/147.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/146.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/148.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/149.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/150.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/152.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/151.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/153.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/154.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/155.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/156.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/157.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/158.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/159.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/160.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/161.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/162.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/163.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/164.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/165.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/166.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/167.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/119.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/120.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/121.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/168.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/125.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/169.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/170.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/130.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/131.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/171.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/172.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/173.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/136.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/137.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/174.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/175.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/176.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/177.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/178.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/179.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/180.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/181.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/182.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/183.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/184.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/185.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/186.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/187.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/188.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/189.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/190.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/191.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/192.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/193.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/194.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/195.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/117.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/118.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/119.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/120.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/121.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/196.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/197+.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/198.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/199.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/200.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/201.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/202.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/203.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/206.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/205.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/204.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/207.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/208.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/209.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/210.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/211.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/212.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/213.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/214.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/215.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/216.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/217.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/218.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/219.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/245.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/246.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/220.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/221.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/222.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/223.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/226.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/227.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/228.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/229.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/230.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/160.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/161.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/231.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/164.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/165.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/166.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/167.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/233.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/234.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/235.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/236.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/237.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/240.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/238.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/241.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/130.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/131.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/242.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/244.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/243.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/136.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/137.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/247.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/248.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/249.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/250.png"><meta property="og:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/256.png"><meta property="article:published_time" content="2023-05-26T14:05:08.121Z"><meta property="article:modified_time" content="2023-07-05T07:13:30.967Z"><meta property="article:author" content="毛"><meta property="article:tag" content="Spark"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/1.png"><link rel="canonical" href="http://example.com/2023/05/26/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>电影推荐系统 | 睡觉万岁</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><script src="https://g.joyinshare.com/hc/ribbon.min.js" type="text/javascript"></script><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><a target="_blank" rel="noopener" href="https://github.com/maduit" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64ceaa;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">睡觉万岁</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-schedule"><a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>日程表</a></li></ul></nav></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://example.com/2023/05/26/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/xiao.png"><meta itemprop="name" content="毛"><meta itemprop="description" content="在梦里啥都有"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="睡觉万岁"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">电影推荐系统</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-05-26 22:05:08" itemprop="dateCreated datePublished" datetime="2023-05-26T22:05:08+08:00">2023-05-26</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2023-07-05 15:13:30" itemprop="dateModified" datetime="2023-07-05T15:13:30+08:00">2023-07-05</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/2023/" itemprop="url" rel="index"><span itemprop="name">2023</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body" itemprop="articleBody"><p>1.创建新的虚拟机</p><h1 id="一、创建虚拟机"><a href="#一、创建虚拟机" class="headerlink" title="一、创建虚拟机"></a>一、创建虚拟机</h1><p>1.<img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/1.png" alt="1685109929770"></p><p>2.<img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/2.png" alt="1685109980203"></p><p>3.官网下载iso文件</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/3.png" alt="1685110006853"></p><ol start="4"><li></li></ol><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/4.png" alt="1685110041330"></p><ol start="5"><li></li></ol><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/5.png" alt="1685110066266"></p><p>6.随变取（maduit 密码：123）</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/6.png" alt="1685110292223"></p><p>7.<img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/7.png" alt="1685110316214"></p><p>8.自定义文件</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/8.png" alt="1685110352421"></p><p>9.内存至少需要4GB</p><p>4核也够了</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/9.png" alt="1685110486547"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/10.png" alt="1685110513052"></p><p>10.自动初始化</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/11.png" alt="1685110546985"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/12.png" alt="1685110595550"></p><p>11.初始化完成，点击bigdata用户</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/13.png" alt="1685110913251"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/78.png" alt="1685255418151"></p><ol start="12"><li></li></ol><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/14.png" alt="1685110980025"></p><p>然后虚拟机的安装就完成了</p><p>emmm ，但是书上说要</p><h5 id="创建一个hadoop用户"><a href="#创建一个hadoop用户" class="headerlink" title="创建一个hadoop用户"></a>创建一个hadoop用户</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo useradd -m hadoop -s /bin/bash</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/16.png" alt="1685111598023"></p><p>设置密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo passwd hadoop</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/17.png" alt="1685111720754"></p><p>切换用户</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/18.png" alt="1685111770370"></p><h5 id="切换下载源"><a href="#切换下载源" class="headerlink" title="切换下载源"></a>切换下载源</h5><p><img src="/images/loading.gif" data-original="C:\Users\GJQ\AppData\Roaming\Typora\typora-user-images\1685171531582.png" alt="1685171531582"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/34.png" alt="1685171458820"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/35.png" alt="1685171599429"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/36.png" alt="1685171618432"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/37.png" alt="1685171647360"></p><h1 id="二、安装vim"><a href="#二、安装vim" class="headerlink" title="二、安装vim"></a>二、安装vim</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get  install vim</span><br></pre></td></tr></table></figure><p>这边得切换到一开始创建的用户（bigdata）那边安装</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/23.png" alt="1685119947481"></p><p>不然会报这个错</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop is not in the sudoers file. This incident will be reported.</span><br></pre></td></tr></table></figure><p>显示了这个说明hadoop用户没有root权限</p><p>然后在bigdata的用户里面打开这个命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo visudo </span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/25.png" alt="1685168070062"></p><p>在最后一行加上</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop  ALL=(ALL:ALL) ALL</span><br></pre></td></tr></table></figure><p>保存关闭之后再切换回hadoop用户</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/24.png" alt="1685167949585"></p><p>然后再执行安装命令就行了</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/26.png" alt="1685169097189"></p><p>如果还是报错，在hadoop用户继续输入<code>sudo visudo</code>这命令 然后保存在执行（我不知到空格有没有影响，反正保持和上面代码命令行一样的空格就好）然后Hadoop用户就可以使用sudo命令了</p><h1 id="三、安装JDK环境"><a href="#三、安装JDK环境" class="headerlink" title="三、安装JDK环境"></a>三、安装JDK环境</h1><p>从百度网盘里的东西直接移动到downloads里面</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/19.png" alt="1685111974555"></p><p>如果不行的话，自己查找vmware tool的东西</p><p>复制完成</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/21.png" alt="1685112959995"></p><p>切换到管理员模式可以减少很多麻烦</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/27.png" alt="1685170106349"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/lib</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo mkdir jvm #创建jvm文件夹用来放JDK文件</span><br><span class="line">cd /home/hadoop/Downloads</span><br><span class="line">tar -zxvf ./jdk-8u162-linux-x64.tar.gz #解压</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/28.png" alt="1685170197086"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/29.png" alt="1685170290984"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv jdk1.8.0_162 /usr/lib/jvm #移动到jvm里</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/30.png" alt="1685170386914"></p><p>回到jvm文件那么发现多了一个</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/31.png" alt="1685170435438"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~ #用于将当前工作目录切换到当前用户的主目录（home directory）</span><br><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><p>在最后输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=&quot;/usr/lib/jvm/jdk1.8.0_162&quot;</span><br><span class="line">CLASSPATH=.:$JAVA_HOME/lib/tools.jar</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">export JAVA_HOME CLASSPATH PATH</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_162</span><br><span class="line">export JRE_HOME=$&#123;JAVA_HOME&#125;/jre</span><br><span class="line">export CLASSPATH=.:$&#123;JAVA_HOME&#125;/lib:$&#123;JRE_HOME&#125;/lib</span><br><span class="line">export PATH=$&#123;JAVA_HOME&#125;/bin:$PATH</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/32.png" alt="1685170892887"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br><span class="line">java -version</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/33.png" alt="1685170968110"></p><p>返回这个就是好的</p><h1 id="四、下载Hadoop"><a href="#四、下载Hadoop" class="headerlink" title="四、下载Hadoop"></a>四、下载Hadoop</h1><h4 id="安装ssh"><a href="#安装ssh" class="headerlink" title="安装ssh"></a>安装ssh</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">apt-get install openssh-server</span><br><span class="line">ssh localhost</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/.ssh/</span><br><span class="line">ssh-keygen -t rsa  #全回车</span><br><span class="line">cat ./id_rsa.pub &gt;&gt; ./authorized_keys</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/39.png" alt="1685175855423"></p><h4 id="安装hadoop"><a href="#安装hadoop" class="headerlink" title="安装hadoop"></a>安装hadoop</h4><p>找到原本下载hadoop安装包的文件夹解压</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf hadoop-2.7.1.tar.gz</span><br><span class="line">sudo mv hadoop-2.7.1 /usr/local #移动</span><br><span class="line">sudo mv hadoop-2.7.1 ./hadoop #改名</span><br><span class="line">sudo chown -R hadoop ./hadoop #修改文件夹权限</span><br></pre></td></tr></table></figure><p>看单机版hadoop信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">./bin/hadoop version</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/40.png" alt="1685190557505"></p><p>因为需要伪分布式，继续伪分布式的配置</p><h5 id="core-site-xml"><a href="#core-site-xml" class="headerlink" title="core-site.xml"></a>core-site.xml</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/etc/hadoop</span><br><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure><p>复制这个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;file:/usr/local/hadoop/tmp&lt;/value&gt;</span><br><span class="line">        &lt;description&gt;Abase for other temporary directories.&lt;/description&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;fs.defaultFS&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;hdfs://localhost:9000&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="hdfs-site-xml"><a href="#hdfs-site-xml" class="headerlink" title="hdfs-site.xml"></a>hdfs-site.xml</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/etc/hadoop</span><br><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure><p>复制这个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.replication&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;1&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;file:/usr/local/hadoop/tmp/dfs/name&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;file:/usr/local/hadoop/tmp/dfs/data&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="hadoop-env-sh"><a href="#hadoop-env-sh" class="headerlink" title="hadoop-env.sh"></a>hadoop-env.sh</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/etc/hadoop</span><br><span class="line">vim hadoop-env.sh</span><br></pre></td></tr></table></figure><p>找到这边添加一个</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># The java implementation to use.</span><br><span class="line">export JAVA_HOME=$&#123;JAVA_HOME&#125;</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_162</span><br></pre></td></tr></table></figure><h5 id="yarn-env-sh"><a href="#yarn-env-sh" class="headerlink" title="yarn-env.sh"></a>yarn-env.sh</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/etc/hadoop</span><br><span class="line">vim yarn-env.sh</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">插入如下代码：</span><br><span class="line">export JAVA_HOME=/usr/lib/jvm/jdk1.8.0_162</span><br></pre></td></tr></table></figure><h5 id="mapred-site-xml文件配置"><a href="#mapred-site-xml文件配置" class="headerlink" title="mapred-site.xml文件配置"></a>mapred-site.xml文件配置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/etc/hadoop</span><br><span class="line">vim mapred-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">    &lt;property&gt;</span><br><span class="line">        &lt;name&gt;mapreduce.framework.name&lt;/name&gt;</span><br><span class="line">        &lt;value&gt;yarn&lt;/value&gt;</span><br><span class="line">    &lt;/property&gt;</span><br><span class="line">&lt;/configuration&gt;</span><br></pre></td></tr></table></figure><h5 id="yarn-site-xml配置"><a href="#yarn-site-xml配置" class="headerlink" title="yarn-site.xml配置"></a>yarn-site.xml配置</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/etc/hadoop</span><br><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;  </span><br><span class="line">&lt;property&gt;  </span><br><span class="line">        &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;  </span><br><span class="line">        &lt;value&gt;mapreduce_shuffle&lt;/value&gt;  </span><br><span class="line">&lt;/property&gt;  </span><br><span class="line">&lt;property&gt;  </span><br><span class="line">        &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;  </span><br><span class="line">        &lt;value&gt;192.168.2.10:8099&lt;/value&gt;  </span><br><span class="line">        &lt;description&gt;这个地址是mr管理界面的&lt;/description&gt;  </span><br><span class="line">&lt;/property&gt;  </span><br><span class="line">&lt;/configuration&gt;  </span><br></pre></td></tr></table></figure><p>执行名称结点格式化</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">./bin/hdfs namenode -format</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/41.png" alt="1685192609644"></p><p>显示这个就是成功</p><p>ps：如果显示没有java啥的，重新看看<code>vim ~/.bashrc</code>里面的东西在不在，然后<code>source</code></p><h4 id="启动hadoop"><a href="#启动hadoop" class="headerlink" title="启动hadoop"></a>启动hadoop</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop/</span><br><span class="line">./sbin/start-dfs.sh</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/42.png" alt="1685192760524"></p><p>打yes</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/43.png" alt="1685194525156"></p><p>再打</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jps</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/44.png" alt="1685195119670"></p><p>成功</p><p>但是还要干点东西，不知道为啥书上没看懂</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">我们在配置文件中配置了一些文件夹路径，现在我们来创建他们，在/usr/local/hadoop/目录下使用hadoop用户操作，建立tmp、hdfs/name、hdfs/data目录，执行如下命令：</span><br><span class="line">mkdir -p /usr/local/hadoop/tmp </span><br><span class="line">mkdir /usr/local/hadoop/hdfs </span><br><span class="line">mkdir /usr/local/hadoop/hdfs/data </span><br><span class="line">mkdir /usr//localhadoop/hdfs/name</span><br></pre></td></tr></table></figure><h5 id="将Hadoop添加到环境变量中"><a href="#将Hadoop添加到环境变量中" class="headerlink" title="将Hadoop添加到环境变量中"></a>将Hadoop添加到环境变量中</h5><p>切换到root用户</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo su</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure><p>插入</p><figure class="highlight plaintext"><figcaption><span>HADOOP_HOME</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</span><br></pre></td></tr></table></figure><p>使之生效</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><p>确保 <code>bin</code> 目录已添加到 <code>PATH</code> 环境变量中</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PATH=/usr/local/hadoop/bin:$PATH</span><br><span class="line">source /etc/profile</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p>现在配置工作已经基本搞定，接下来只需要完成：1.格式化<code>HDFS</code>文件、2.启动<code>hadoop</code>、3.验证<code>Hadoop</code> 即可。</p><h5 id="格式化"><a href="#格式化" class="headerlink" title="格式化"></a>格式化</h5><p>在使用<code>Hadoop</code>之前我们需要格式化一些<code>hadoop</code>的基本信息。 使用如下命令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop namenode -format</span><br></pre></td></tr></table></figure><p>出现如下界面代表成功：</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/45.png" alt="1685196452276"></p><h5 id="启动Hadoop"><a href="#启动Hadoop" class="headerlink" title="启动Hadoop"></a>启动Hadoop</h5><p>接下来我们启动<code>Hadoop</code>：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/46.png" alt="预览大图"></p><p>这个是表示启动没成功，是因为<code>root</code>用户现在还不能启动<code>hadoop</code>，我们来设置一下就可以了。</p><p>在<code>/hadoop/sbin</code>路径下： <code>cd /usr/local/hadoop/sbin</code>。</p><p>将<code>start-dfs.sh</code>，<code>stop-dfs.sh</code>两个文件顶部添加以下参数</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line">HDFS_DATANODE_USER=root</span><br><span class="line">HADOOP_SECURE_DN_USER=hdfs</span><br><span class="line">HDFS_NAMENODE_USER=root</span><br><span class="line">HDFS_SECONDARYNAMENODE_USER=root</span><br></pre></td></tr></table></figure><p>还有，<code>start-yarn.sh</code>，<code>stop-yarn.sh</code>顶部也需添加以下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env bash</span><br><span class="line">YARN_RESOURCEMANAGER_USER=root</span><br><span class="line">HADOOP_SECURE_DN_USER=yarn</span><br><span class="line">YARN_NODEMANAGER_USER=root</span><br></pre></td></tr></table></figure><p>再次启动<code>start-dfs.sh</code>，最后输入命令 <code>jps</code> 验证,出现如下界面代表启动成功：</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/44.png" alt="1685195119670"></p><p><em><strong>下次启动就不要再执行namenode -format那个命令了！！！！</strong></em></p><h1 id="五、HDFS操作常用Shell命令"><a href="#五、HDFS操作常用Shell命令" class="headerlink" title="五、HDFS操作常用Shell命令"></a>五、HDFS操作常用Shell命令</h1><h4 id="1-1-启动HDFS服务"><a href="#1-1-启动HDFS服务" class="headerlink" title="1.1 启动HDFS服务"></a>1.1 启动HDFS服务</h4><p>1.使用start-dfs.sh命令启动</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-dfs.sh</span><br></pre></td></tr></table></figure><p>2.使用JPS命令查看是否启动成功<br><strong>jps</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/44.png" alt="1685195119670"></p><h4 id="1-2-help-命令"><a href="#1-2-help-命令" class="headerlink" title="1.2 help 命令"></a>1.2 help 命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs  dfs  -help</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/47.png" alt="1685198775065"></p><h4 id="1-3-ls-命令"><a href="#1-3-ls-命令" class="headerlink" title="1.3 ls 命令"></a>1.3 ls 命令</h4><p>功能：显示目录信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -ls /</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/48.png" alt="1685198866616"></p><p><em>可以看到找到一个&#x2F;user文件</em></p><h4 id="1-4-mkdir-命令"><a href="#1-4-mkdir-命令" class="headerlink" title="1.4 mkdir 命令"></a>1.4 mkdir 命令</h4><p>功能：在 hdfs 上创建目录</p><p>1.在根目录的 user 文件夹下创建 hadoop 文件夹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">hdfs dfs -mkdir  /user/hadoop</span><br></pre></td></tr></table></figure><p>2.使用 ls 命令查看，可以看到出现了hadoop 文件夹：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs  dfs -ls  /user</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/49.png" alt="1685199066453"></p><h4 id="1-5-put-命令"><a href="#1-5-put-命令" class="headerlink" title="1.5 put 命令"></a>1.5 put 命令</h4><p>功能：上传 Linux 系统中的文件到 HDFS 文件系统的指定目录</p><p>1.首先使用 vi 命令在 linux本地编辑一份数据文件 输入命令：vi stu01.txt</p><p><strong>vi stu01.txt</strong></p><p>按 <strong>i键</strong>进入编辑模式，左下角出现–INSERT–字符后，输入以下内容，</p><p><strong>234</strong></p><p><strong>5678</strong></p><p><strong>Hadoop</strong></p><p>然后按<strong>ESC 键</strong>，左下角–INSERT–字符消失后，在英文输入状态下输入 <strong>:wq</strong> ，回车保存退出文件。</p><p>2.将刚刚创建的stu01.txt文件上传到HDFS上面</p><p><strong>hdfs dfs -put stu01.txt &#x2F;user&#x2F;hadoop</strong></p><p>3.使用 ls 命令查看，可以看到出现了stu01.txt文件</p><p><strong>hdfs dfs -ls &#x2F;user&#x2F;hadoop</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/50.png" alt="1685202619219"></p><h4 id="1-6-cat-命令"><a href="#1-6-cat-命令" class="headerlink" title="1.6 cat 命令"></a>1.6 cat 命令</h4><p>功能：显示文件内容</p><p><strong>hdfs dfs -cat &#x2F;user&#x2F;hadoop&#x2F;stu01.txt</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/51.png" alt="1685202707851"></p><h4 id="1-7-text-命令"><a href="#1-7-text-命令" class="headerlink" title="1.7 text 命令"></a>1.7 text 命令</h4><p>功能：以字符形式打印一个文件的内容</p><p><strong>hdfs dfs -text &#x2F;user&#x2F;hadoop&#x2F;stu01.txt</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/52.png" alt="1685202765362"></p><h4 id="1-8-cp-命令"><a href="#1-8-cp-命令" class="headerlink" title="1.8 cp 命令"></a>1.8 cp 命令</h4><p>功能：从 hdfs 的一个路径拷贝 hdfs 的另一个路径</p><p>1.查看HDFS上的根目录下的内容</p><p><strong>hdfs dfs -ls &#x2F;</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/53.png" alt="1685202832771"></p><p>2.查看HDFS上的&#x2F;user&#x2F;hadoop下的内容<br><strong>hdfs dfs -ls &#x2F;user&#x2F;hadoop</strong></p><p>3.将&#x2F;user&#x2F;hadoop下的stu01.txt拷贝到根目录下</p><p><strong>hdfs dfs -cp &#x2F;user&#x2F;hadoop&#x2F;stu01.txt &#x2F;</strong></p><p>4.再次查看HDFS上的根目录下的内容</p><p><strong>hdfs dfs -ls &#x2F;</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/54.png" alt="1685202983534"></p><p><em>从上面的图中可以看出文件已经被复制到了HDFS的根目录下。</em></p><h4 id="1-9-mv-命令"><a href="#1-9-mv-命令" class="headerlink" title="1.9 mv 命令"></a>1.9 mv 命令</h4><p>功能：从 hdfs 的一个路径拷贝 hdfs 的另一个路径</p><p>1.在HDFS上面创建一个新的目录<br><strong>hdfs dfs -mkdir &#x2F;user&#x2F;hadoop2</strong><br><strong>hdfs dfs -ls &#x2F;user</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/55.png" alt="1685203093936"></p><p>2.查看HDFS上的根目录下的内容<br><strong>hdfs dfs -ls &#x2F;</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/56.png" alt="1685203176090"></p><p>3.将跟目录下的stu01.txt移动到&#x2F;user&#x2F;hadoop2下</p><p><strong>hdfs dfs -mv &#x2F;stu01.txt &#x2F;user&#x2F;hadoop2</strong></p><p>4.再次查看HDFS上的根目录下的内容</p><p><strong>hdfs dfs -ls &#x2F;</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/57.png" alt="1685203297506"></p><p>5.查看&#x2F;user&#x2F;stu02下的内容<br><strong>hdfs dfs -ls &#x2F;user&#x2F;hadoop2</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/58.png" alt="1685203353082"></p><p><em>从上面的图中可以看出文件已经被移动到了&#x2F;user&#x2F;stu02的根目录下。</em></p><h4 id="1-10-rm-命令"><a href="#1-10-rm-命令" class="headerlink" title="1.10 rm 命令"></a>1.10 rm 命令</h4><p>功能：删除 hdfs 文件或文件夹</p><p>1.将HDFS上面的&#x2F;user&#x2F;hadoop&#x2F;stu01.txt文件删除</p><p><strong>hdfs dfs -rm &#x2F;user&#x2F;hadoop&#x2F;stu01.txt</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/59.png" alt="1685203456655"></p><p><strong>hdfs dfs -ls &#x2F;user&#x2F;hadoop</strong><br><em>没有显示stu01.txt结果，则正确。</em></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/60.png" alt="1685203653530"></p><p>2.将HDFS上面的&#x2F;user&#x2F;hadoop&#x2F;input&#x2F;文件夹删除<br><strong>hdfs dfs -rm -r &#x2F;user&#x2F;hadoop&#x2F;input</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/61.png" alt="1685203722917"></p><p><strong>hdfs dfs -ls &#x2F;user&#x2F;hadoop</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/62.png" alt="1685203775061"></p><p>删除成功</p><h4 id="2-1-moveFromLocal命令"><a href="#2-1-moveFromLocal命令" class="headerlink" title="2.1 moveFromLocal命令"></a>2.1 moveFromLocal命令</h4><p>功能：从本地剪切粘贴到 hdfs</p><p>1.使用 vi 命令在 linux 本地先创建一个数据文件，stu01_2.txt</p><p><strong>vi stu01_2.txt</strong> 按 i 进入编辑模式，输入内容，</p><p>**hadoop **</p><p><strong>hive</strong></p><p>然后按 esc 键，再同时按下 shift 和冒号键，输入 wq，保存退出。</p><p>2.查看本地目录中的文件</p><p><strong>ls</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/63.png" alt="1685204261895"></p><p>3.将该文件从本地剪切粘贴到 hdfs</p><p><strong>hdfs dfs -mkdir &#x2F;user&#x2F;hadoop&#x2F;</strong></p><p><strong>hdfs dfs -moveFromLocal stu01-2.txt &#x2F;user&#x2F;hadoop&#x2F;</strong></p><p>4.查看本地文件</p><p><strong>ls</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/64.png" alt="1685204419455"></p><p>5.查看HDFS上面的文件</p><p><strong>hdfs dfs -ls &#x2F;user&#x2F;hadoop&#x2F;</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/65.png" alt="1685204477195"></p><p>6.查看文件的内容</p><p><strong>hdfs dfs -cat &#x2F;user&#x2F;hadoop&#x2F;stu01-2.txt</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/66.png" alt="1685204545062"></p><p><em>可以看到和我们写入的内容一致，而且本地中也没有了该文件，该文件已经被剪切到了HDFS上面。</em></p><h4 id="2-2-appendToFile-命令"><a href="#2-2-appendToFile-命令" class="headerlink" title="2.2 appendToFile 命令"></a>2.2 appendToFile 命令</h4><p>功能：追加一个文件到已经存在的文件末尾</p><p>1.创建本地stu01.txt文件的内容</p><p><strong>vi stu01.txt</strong></p><p>按下<strong>i</strong>键进入编辑模式，左下角出现–INSERT–后，将以下内容输入</p><p><strong>234</strong></p><p><strong>5678</strong></p><p><strong>Hadoop</strong></p><p>输入完成后，按下<strong>ESC键</strong>，左下角–INSERT–消失后，在英文状态下输入 <strong>:wq</strong> ，回车保存退出文件。</p><p>2.查看HDFS上面的stu01-2.txt文件的内容</p><p><strong>hdfs dfs -cat &#x2F;user&#x2F;hadoop&#x2F;stu01-2.txt</strong></p><p><code>234</code></p><p><code>5678</code></p><p><code>hadoop</code></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/67.png" alt="1685204861869"></p><p>3.将本地stu01.txt文件的内容追加写到HDFS上面的stu01_2.txt文件中</p><p><strong>hdfs dfs -appendToFile stu01.txt &#x2F;user&#x2F;hadoop&#x2F;stu01-2.txt</strong></p><p>4.再次查看HDFS上面的stu01-2.txt文件的内容</p><p><strong>hdfs dfs -cat &#x2F;user&#x2F;hadoop&#x2F;stu01-2.txt</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/68.png" alt="1685204947959"></p><h4 id="2-3-get-命令"><a href="#2-3-get-命令" class="headerlink" title="2.3 get 命令"></a>2.3 get 命令</h4><p>功能：等同于 copyToLocal，就是从 hdfs 下载文件到本地</p><p>1.查看本地目录中的文件</p><p><strong>ls</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/69.png" alt="1685205045298"></p><p>2.将stu01_2.txt文件下载到本地</p><p>**hdfs dfs -get &#x2F;user&#x2F;hadoop&#x2F;stu01-2.txt **</p><p>3.查看本地目录中的文件</p><p><strong>ls</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/70.png" alt="1685205084641"></p><p>4.查看stu01-2.txt中的内容</p><p><strong>cat stu01_2.txt</strong></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/71.png" alt="1685205126650"></p><h1 id="六、Spark下载"><a href="#六、Spark下载" class="headerlink" title="六、Spark下载"></a>六、Spark下载</h1><p>进入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/hadoop/Downloads</span><br><span class="line">tar -zxvf spark-2.1.0-bin-without-hadoop.tgz</span><br><span class="line">mv spark-2.1.0-bin-without-hadoop  spark #改名</span><br><span class="line">sudo spark /usr/local </span><br></pre></td></tr></table></figure><p>加上权限</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo chown -R hadoop:hadoop ./spark</span><br></pre></td></tr></table></figure><p>复制一份</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cp ./conf/spark-env.sh.template  ./conf/spark-env.sh</span><br></pre></td></tr></table></figure><p>编辑</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim spark-env.sh</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export SPARK_DIST_CLASSPATH=$(/usr/local/hadoop/bin/hadoop classpath)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/79.png" alt="1685260995121"></p><p>检验是否成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark</span><br><span class="line">bin/run-example SparkPi</span><br></pre></td></tr></table></figure><p>过滤</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin/run-example  SparkPi 2&gt;&amp;1 | grep &quot;Pi is roughly&quot;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/80.png" alt="1685261139576"></p><h1 id="七、在spark-shell中运行"><a href="#七、在spark-shell中运行" class="headerlink" title="七、在spark-shell中运行"></a>七、在spark-shell中运行</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark</span><br><span class="line"> ./bin/spark-shell</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/81.png" alt="1685262195916"></p><h1 id="八、安装MySQL"><a href="#八、安装MySQL" class="headerlink" title="八、安装MySQL"></a>八、安装MySQL</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install mysql-server</span><br></pre></td></tr></table></figure><p>启动mysql服务</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql stop 先手动关</span><br><span class="line">service mysql start再手动开</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/82.png" alt="1685262504893"></p><p>看是否成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo netstat -tap | grep mysql</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/83.png" alt="1685262547044"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/84.png" alt="1685262954690"></p><p>没有权限</p><p>用</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo mysql -u root -p</span><br></pre></td></tr></table></figure><p>然后输入这个 密码输入是’123’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ALTER USER &#x27;root&#x27;@&#x27;localhost&#x27; IDENTIFIED WITH mysql_native_password BY &#x27;123&#x27;;</span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/85.png" alt="1685263053475"></p><p>好了</p><p>修改乱码问题</p><p><code>atin1</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;char%&quot;;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/86.png" alt="1685263155580"></p><p>修改配置文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /etc/mysql/mysql.conf.d/</span><br><span class="line">vim mysqlb.cnf</span><br></pre></td></tr></table></figure><p>在mysqld.cnf添加</p><p><code>character_set_server=utf8</code></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/87.png" alt="1685263422570"></p><p>重启mysql</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service mysql restart</span><br></pre></td></tr></table></figure><p>再进去mysql</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p>再查看编码方式</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &quot;char%&quot;;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/88.png" alt="1685263835946"></p><p>好了</p><h3 id="mysql常用操作"><a href="#mysql常用操作" class="headerlink" title="mysql常用操作"></a>mysql常用操作</h3><h6 id="1-1显示数据库"><a href="#1-1显示数据库" class="headerlink" title="1.1显示数据库"></a>1.1显示数据库</h6><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show databases;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/89.png" alt="1685263940575"></p><h5 id="2-2显示数据库中的表"><a href="#2-2显示数据库中的表" class="headerlink" title="2.2显示数据库中的表"></a>2.2显示数据库中的表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use mysql;</span><br><span class="line">show tables;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/90.png" alt="1685264067018"></p><h5 id="3-3显示数据表的结构"><a href="#3-3显示数据表的结构" class="headerlink" title="3.3显示数据表的结构"></a>3.3显示数据表的结构</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">describe user(表名);</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/91.png" alt="1685264110204"></p><h5 id="3-4查询表中的记录"><a href="#3-4查询表中的记录" class="headerlink" title="3.4查询表中的记录"></a>3.4查询表中的记录</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from user(表名);</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/92.png" alt="1685264219643"></p><h5 id="3-5创建数据库"><a href="#3-5创建数据库" class="headerlink" title="3.5创建数据库"></a>3.5创建数据库</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database 库名;</span><br></pre></td></tr></table></figure><p>创建一个名称为aaa</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database aaa;</span><br></pre></td></tr></table></figure><h5 id="3-6创建表"><a href="#3-6创建表" class="headerlink" title="3.6创建表"></a>3.6创建表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use 库名;</span><br><span class="line">create table 表名(字段设定列表);</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">use aaa;</span><br><span class="line">create table person (id int(3) auto_increment not null primary key,xm varchar(10),xb varchar(2),csny date);</span><br></pre></td></tr></table></figure><p>显示person表的结构</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">describe person;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/93.png" alt="1685264596457"></p><h5 id="3-7增加记录"><a href="#3-7增加记录" class="headerlink" title="3.7增加记录"></a>3.7增加记录</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">insert into person values(null,&#x27;张三&#x27;,&#x27;男&#x27;,&#x27;1997-01-02&#x27;);</span><br><span class="line">insert into person values(null,&#x27;李四&#x27;,&#x27;女&#x27;,&#x27;1998-05-04&#x27;);</span><br></pre></td></tr></table></figure><p>用select查询person表的记录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from person;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/94.png" alt="1685264874151"></p><h5 id="3-8修改记录"><a href="#3-8修改记录" class="headerlink" title="3.8修改记录"></a>3.8修改记录</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update person set csny=&#x27;1971-01-10&#x27; where xm=&#x27;张三&#x27;;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/95.png" alt="1685264965167"></p><h5 id="3-9删除记录"><a href="#3-9删除记录" class="headerlink" title="3.9删除记录"></a>3.9删除记录</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">delete from person where xm=&#x27;张三&#x27;;</span><br></pre></td></tr></table></figure><h5 id="3-10删除数据库和表"><a href="#3-10删除数据库和表" class="headerlink" title="3.10删除数据库和表"></a>3.10删除数据库和表</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop database 库名;</span><br><span class="line">drop table 表名;</span><br></pre></td></tr></table></figure><h5 id="3-11看mysql版本"><a href="#3-11看mysql版本" class="headerlink" title="3.11看mysql版本"></a>3.11看mysql版本</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show variables like &#x27;version&#x27;;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/96.png" alt="1685265089600"></p><h1 id="九、Scala安装"><a href="#九、Scala安装" class="headerlink" title="九、Scala安装"></a>九、Scala安装</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd /home/hadoop/Downloads</span><br><span class="line">tar -zxvf scala-2.11.8.tgz</span><br><span class="line">mv scala-2.11.8  scala #改名</span><br><span class="line">sudo scala /usr/local </span><br><span class="line">vim ~/.bashrc</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export PATH=$PATH:/usr/local/scala/bin</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>检查scala是否安装成功</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scala</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/97.png" alt="1685269159574"></p><h1 id="十、IntelliJ-IDEA开发工具的安装和使用方法"><a href="#十、IntelliJ-IDEA开发工具的安装和使用方法" class="headerlink" title="十、IntelliJ IDEA开发工具的安装和使用方法"></a>十、IntelliJ IDEA开发工具的安装和使用方法</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /home/hadoop/Downloads</span><br><span class="line">tar -zxvf ideaIU-2017.3.5.tar.gz</span><br><span class="line">mv idea-IU-173.4674.33 idea  #改名</span><br><span class="line">sudo mv idea /usr/local </span><br></pre></td></tr></table></figure><h1 id="十一、启动IDEA"><a href="#十一、启动IDEA" class="headerlink" title="十一、启动IDEA"></a>十一、启动IDEA</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/idea</span><br><span class="line">./bin/idea.sh</span><br></pre></td></tr></table></figure><p>会显示</p><p>一个界面忘记截图了</p><p>然后</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/98.png" alt="1685270925380"></p><p>我选的evaluate for free</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/99.png" alt="1685271025736"></p><h4 id="1-为IDEA安装Scala插件"><a href="#1-为IDEA安装Scala插件" class="headerlink" title="1.为IDEA安装Scala插件"></a>1.为IDEA安装Scala插件</h4><p>点plugins</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/100.png" alt="1685271144033"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/101.png" alt="1685271268655"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/102.png" alt="1685271312332"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/103.png" alt="1685271339540"></p><h4 id="2-配置JDK"><a href="#2-配置JDK" class="headerlink" title="2.配置JDK"></a>2.配置JDK</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/104.png" alt="1685271410325"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/105.png" alt="1685271441447"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/106.png" alt="1685271471890"></p><h4 id="3-创建一个新项目WordCount"><a href="#3-创建一个新项目WordCount" class="headerlink" title="3.创建一个新项目WordCount"></a>3.创建一个新项目WordCount</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/107.png" alt="1685271523118"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/108.png" alt="1685271563074"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/109.png" alt="1685271626948"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/110.png" alt="1685271651301"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/111.png" alt="1685271769565"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/112.png" alt="1685271806997"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/113.png" alt="1685271836024"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/114.png" alt="1685271870252"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/115.png" alt="1685271886513"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/116.png" alt="1685271905730"></p><h4 id="4-设置目录"><a href="#4-设置目录" class="headerlink" title="4.设置目录"></a>4.设置目录</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/117.png" alt="1685271994038"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/118.png" alt="1685272015590"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/119.png" alt="1685272055139"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/120.png" alt="1685272092519"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/121.png" alt="1685272125104"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/122.png" alt="1685272147217"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/123.png" alt="1685272271767"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkContext</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkContext</span>._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</span><br><span class="line">    <span class="keyword">val</span> inputFile =  <span class="string">&quot;file:///usr/local/spark/mycode/wordcount/word.txt&quot;</span></span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">&quot;WordCount&quot;</span>).setMaster(<span class="string">&quot;local&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br><span class="line">    <span class="keyword">val</span> textFile = sc.textFile(inputFile)</span><br><span class="line">    <span class="keyword">val</span> wordCount = textFile.flatMap(line =&gt; line.split(<span class="string">&quot; &quot;</span>)).map(word =&gt; (word, <span class="number">1</span>)).reduceByKey((a, b) =&gt; a + b)</span><br><span class="line">    wordCount.foreach(println)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>记得去mycode里面船舰一个wordcount</p><h4 id="5-配置pom-xml文件"><a href="#5-配置pom-xml文件" class="headerlink" title="5.配置pom.xml文件"></a>5.配置pom.xml文件</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/124.png" alt="1685272480099"></p><p>输入</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>dblab<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>WordCount<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spark.version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">spark.version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scala.version</span>&gt;</span>2.11<span class="tag">&lt;/<span class="name">scala.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_$&#123;scala.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-streaming_$&#123;scala.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_$&#123;scala.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-hive_$&#123;scala.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-mllib_$&#123;scala.version&#125;<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.scala-tools<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-scala-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.15.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>testCompile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-compiler-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.6.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">source</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">target</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-surefire-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">skip</span>&gt;</span>true<span class="tag">&lt;/<span class="name">skip</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/125.png" alt="1685272619864"></p><p>emm….因为前面没有安装maven所以，压根九不能自动生成</p><p>首先装一下maven</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install maven</span><br></pre></td></tr></table></figure><p>命令检查 Maven 是否已安装：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn -v</span><br></pre></td></tr></table></figure><p>然后在terminal里面输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mvn clean install</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/126.png" alt="1685274127953"></p><p>然后就自动安装依赖环境了，有点久</p><p>然后</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/127.png" alt="1685278544534"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/129.png" alt="1685282343457"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/128.png" alt="1685282309762"></p><p>搞定了</p><h4 id="6-打包WordCount程序生成JAR包"><a href="#6-打包WordCount程序生成JAR包" class="headerlink" title="6.打包WordCount程序生成JAR包"></a>6.打包WordCount程序生成JAR包</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/130.png" alt="1685282444814"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/131.png" alt="1685282485542"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/132.png" alt="1685282560600"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/133.png" alt="1685282626558"></p><p>只保留这两个</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/134.png" alt="1685282715895"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/135.png" alt="1685283580402"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/136.png" alt="1685283604818"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/137.png" alt="1685283626589"></p><p>生成的JAR在~&#x2F;IdeaProjects&#x2F;WordCount&#x2F;out&#x2F;artifacts&#x2F;WordCount_jar&#x2F;WordCount.jar</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/138.png" alt="1685283743535"></p><h4 id="7-把JAR包提交到Spark中运行"><a href="#7-把JAR包提交到Spark中运行" class="headerlink" title="7.把JAR包提交到Spark中运行"></a>7.把JAR包提交到Spark中运行</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark</span><br><span class="line">./bin/spark-submit --class &quot;WordCount&quot; ~/IdeaProjects/WordCount/out/artifacts/WordCount_jar/WordCount.jar</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/139.png" alt="1685284011953"></p><h1 id="十二、安装Kettle"><a href="#十二、安装Kettle" class="headerlink" title="十二、安装Kettle"></a>十二、安装Kettle</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local</span><br><span class="line">sudo mkdir kettle</span><br><span class="line">sudo chown -R hadoop ./kettle #用用户赋予针对kettle目录的操作权限</span><br></pre></td></tr></table></figure><p>把安装包data-integration.zip解压到安装目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">sudo unzip ~/Downloads/data-integration.zip</span><br><span class="line">sudo mv data-integration /usr/local/kettle</span><br></pre></td></tr></table></figure><h4 id="1-复制MySQL数据库驱动程序JAR包"><a href="#1-复制MySQL数据库驱动程序JAR包" class="headerlink" title="1.复制MySQL数据库驱动程序JAR包"></a>1.复制MySQL数据库驱动程序JAR包</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Downloads</span><br><span class="line">sudo unzip mysql-connector-java-5.1.40.zip</span><br><span class="line">sudo cp ./mysql-connector-java-5.1.40/mysql-connector-java-5.1.40 /usr/local/kettle/data-integration/lib</span><br></pre></td></tr></table></figure><h4 id="2-启动Kettle中的Spoon"><a href="#2-启动Kettle中的Spoon" class="headerlink" title="2.启动Kettle中的Spoon"></a>2.启动Kettle中的Spoon</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/kettle/data-integration</span><br><span class="line">chmod +x spoon.sh #设置权限</span><br><span class="line">sudo ./spoon.sh</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/140.png" alt="1685285957893"></p><h4 id="3-使用Kettle把数据加载到HDFS中"><a href="#3-使用Kettle把数据加载到HDFS中" class="headerlink" title="3.使用Kettle把数据加载到HDFS中"></a>3.使用Kettle把数据加载到HDFS中</h4><ul><li>配置Kettle</li></ul><p>先创建一个word.txt文件</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">vim word.txt</span><br></pre></td></tr></table></figure><p>随便输入一点英文</p><p>然后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/kettle/data-integration/plugins/pentaho-big-data-plugin/hadoop-configurations/cdh55/</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim config.properties </span><br></pre></td></tr></table></figure><p>最后一行输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">authentication.superuser.provider=NO_AUTH</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mv core-site.xml ./core-site.xml.bak</span><br><span class="line">mv mapred-site.xml ./mapred-site.xml.bak</span><br><span class="line">mv yarn-site.xml ./yarn-site.xml.bak</span><br><span class="line">cp /usr/local/hadoop/etc/hadoop/mapred-site.xml ./mapred-site.xml</span><br><span class="line">cp /usr/local/hadoop/etc/hadoop/yarn-site.xml ./</span><br><span class="line">cp /usr/local/hadoop/etc/hadoop/core-site.xml ./</span><br></pre></td></tr></table></figure><ul><li>新建作业</li></ul><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/141.png" alt="1685334227311"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/142.png" alt="1685334262155"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/143.png" alt="1685334291930"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/144.png" alt="1685334370303"></p><p>这边的post端口必须和之前配置的core-site.xml的设置一样，其他参数可以不改动</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/145.png" alt="1685334394578"></p><p>点击测试后就是下面三×，其他全勾才对。得保证hadoop开启了。<img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/147.png" alt="1685334916654"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/146.png" alt="1685334574781"></p><ul><li>添加START组件</li></ul><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/148.png" alt="1685335309177"></p><p>拖拽一个START到右侧</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/149.png" alt="1685335404082"></p><p>然后去JHDFS创建目录input_spark</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">hdfs dfs -mkdir /input_spark</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/150.png" alt="1685335697903"></p><p>建立连接（按住shift和鼠标左键）</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/152.png" alt="1685336425475"></p><p>双击 Hadoop Copy File 那么设置</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/151.png" alt="1685335750060"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/153.png" alt="1685336517970"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/154.png" alt="1685336542756"></p><p>执行成功</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/155.png" alt="1685336580568"></p><p>然后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">hdfs dfs -ls /input_spark</span><br></pre></td></tr></table></figure><p>就能看到信息</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/156.png" alt="1685336783168"></p><p><em><strong>那么做的意义是用工具kettle把数据从本地文件加载到HDFS中</strong></em></p><h1 id="十三、使用Spark-SQL读写MySQL数据库的方法"><a href="#十三、使用Spark-SQL读写MySQL数据库的方法" class="headerlink" title="十三、使用Spark SQL读写MySQL数据库的方法"></a>十三、使用Spark SQL读写MySQL数据库的方法</h1><h4 id="1-创建MySQL数据库"><a href="#1-创建MySQL数据库" class="headerlink" title="1.创建MySQL数据库"></a>1.创建MySQL数据库</h4><p>启动数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><p>创建数据库和表</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create database spark;</span><br><span class="line">use spark;</span><br><span class="line">create table student (id int(4), name char(20),gender char(4),age int (4));</span><br><span class="line">insert into student values(1,&#x27;Xueqian&#x27;,&#x27;F&#x27;,23);</span><br><span class="line">insert into student values(2,&#x27;Weiliang&#x27;,&#x27;M&#x27;,24);</span><br><span class="line">select * from student;</span><br></pre></td></tr></table></figure><h4 id="2-在spark-shell中读写mysql数据库"><a href="#2-在spark-shell中读写mysql数据库" class="headerlink" title="2.在spark-shell中读写mysql数据库"></a>2.在spark-shell中读写mysql数据库</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Downloads</span><br><span class="line"> cp ./mysql-connector-java-5.1.40/mysql-connector-java-5.1.40-bin.jar /usr/local/spark/jars/</span><br></pre></td></tr></table></figure><p>启动spark shell 时，必须指定MySQL连接驱动JAR包，</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark</span><br><span class="line">./bin/spark-shell --jars /usr/local/spark/jars/mysql-connector-java-5.1.40-bin.jar  --driver-class-path /usr/local/spark/jars/mysql-connector-java-5.1.40-bin.jar </span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/157.png" alt="1685338120883"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; val jdbcDF= spark.read.format(&quot;jdbc&quot;).</span><br><span class="line">     option(&quot;url&quot;,&quot;jdbc:mysql://localhost:3306/spark&quot;).</span><br><span class="line">     option(&quot;driver&quot;,&quot;com.mysql.jdbc.Driver&quot;).</span><br><span class="line">     option(&quot;dbtable&quot;,&quot;student&quot;).</span><br><span class="line">     option(&quot;user&quot;,&quot;root&quot;).</span><br><span class="line">     option(&quot;password&quot;,&quot;123&quot;).</span><br><span class="line">     option(&quot;useSSL&quot;, &quot;false&quot;).</span><br><span class="line">     load()</span><br></pre></td></tr></table></figure><p>如果出现了，不用在意，好像对下面操作影响不大</p><hr><p>Sun May 28 22:52:36 PDT 2023 WARN: Establishing SSL connection without server’s identity verification is not recommended. According to MySQL 5.5.45+, 5.6.26+ and 5.7.6+ requirements SSL connection must be established by default if explicit option isn’t set. For compliance with existing applications not using SSL the verifyServerCertificate property is set to ‘false’. You need either to explicitly disable SSL by setting useSSL&#x3D;false, or set useSSL&#x3D;true and provide truststore for server certificate verification.<br>jdbcDF: org.apache.spark.sql.DataFrame &#x3D; [id: int, name: string … 2 more fields]</p><hr><p>输入</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbcDF.show()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/158.png" alt="1685340272475"></p><h4 id="3-向MySQL数据库写入数据"><a href="#3-向MySQL数据库写入数据" class="headerlink" title="3.向MySQL数据库写入数据"></a>3.向MySQL数据库写入数据</h4><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以下代码需要一行一行地输入到spark-shell交互式环境中执行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">Properties</span> </span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">Row</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//下面设置两条数据，表示两个学生的信息</span></span><br><span class="line"><span class="keyword">val</span> studentRDD = spark.sparkContext.parallelize(<span class="type">Array</span>(<span class="string">&quot;3 Rongcheng M 26&quot;</span>,<span class="string">&quot;4 Guanhua M 27&quot;</span>)).map(_.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line"> </span><br><span class="line"><span class="comment">//下面设置模式信息</span></span><br><span class="line"><span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">List</span>(<span class="type">StructField</span>(<span class="string">&quot;id&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">true</span>),<span class="type">StructField</span>(<span class="string">&quot;name&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),<span class="type">StructField</span>(<span class="string">&quot;gender&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),<span class="type">StructField</span>(<span class="string">&quot;age&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">true</span>)))</span><br><span class="line"> </span><br><span class="line"><span class="comment">//下面创建Row对象，每个Row对象都是rowRDD中的一行</span></span><br><span class="line"><span class="keyword">val</span> rowRDD = studentRDD.map(p =&gt; <span class="type">Row</span>(p(<span class="number">0</span>).toInt, p(<span class="number">1</span>).trim, p(<span class="number">2</span>).trim, p(<span class="number">3</span>).toInt))</span><br><span class="line"> </span><br><span class="line"><span class="comment">//建立起Row对象和模式之间的对应关系，也就是把数据和模式对应起来</span></span><br><span class="line"><span class="keyword">val</span> studentDF = spark.createDataFrame(rowRDD, schema)</span><br><span class="line"> </span><br><span class="line"><span class="comment">//下面创建一个prop变量用来保存JDBC连接参数</span></span><br><span class="line"><span class="keyword">val</span> prop = <span class="keyword">new</span> <span class="type">Properties</span>()</span><br><span class="line">prop.put(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;root&quot;</span>) <span class="comment">//表示用户名是root</span></span><br><span class="line">prop.put(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;123&quot;</span>) <span class="comment">//表示密码是123</span></span><br><span class="line">prop.put(<span class="string">&quot;driver&quot;</span>,<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>) <span class="comment">//表示驱动程序是com.mysql.jdbc.Driver</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//下面连接数据库，采用append模式，表示追加记录到数据库spark的student表中</span></span><br><span class="line">studentDF.write.mode(<span class="string">&quot;append&quot;</span>).jdbc(<span class="string">&quot;jdbc:mysql://localhost:3306/spark&quot;</span>,<span class="string">&quot;spark.student&quot;</span>,prop)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jdbcDF.show()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/159.png" alt="1685353146978"></p><h4 id="4-编写独立应用程序读写MySQL数据库"><a href="#4-编写独立应用程序读写MySQL数据库" class="headerlink" title="4.编写独立应用程序读写MySQL数据库"></a>4.编写独立应用程序读写MySQL数据库</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/160.png" alt="1685353875195"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/161.png" alt="1685353929474"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/162.png" alt="1685353976875"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/163.png" alt="1685354043177"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/164.png" alt="1685354118424"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/165.png" alt="1685354165755"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/166.png" alt="1685354350410"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/167.png" alt="1685354421083"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/119.png" alt="1685272055139"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/120.png" alt="1685272092519"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/121.png" alt="1685272125104"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/168.png" alt="1685354538874"></p><p>在SparkOperateMySQL写入</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.<span class="type">Properties</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">SparkOperateMySQL</span></span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark= <span class="type">SparkSession</span>.builder().appName(<span class="string">&quot;sqltest&quot;</span>).master(<span class="string">&quot;local[2]&quot;</span>).getOrCreate()</span><br><span class="line">    <span class="keyword">val</span> jdbcDF = spark.</span><br><span class="line">      read.format(<span class="string">&quot;jdbc&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;jdbc:mysql://localhost:3306/spark&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;driver&quot;</span>,<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;dbtable&quot;</span>, <span class="string">&quot;student&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123&quot;</span>).load()</span><br><span class="line">    jdbcDF.show()</span><br><span class="line">    <span class="keyword">val</span> studentRDD = spark.sparkContext.parallelize(<span class="type">Array</span>(<span class="string">&quot;5 Chenglu F 22&quot;</span>,<span class="string">&quot;6 Linzhe M 23&quot;</span>)).map(_.split(<span class="string">&quot; &quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> rowRDD = studentRDD.map(p =&gt; <span class="type">Row</span>(p(<span class="number">0</span>).toInt, p(<span class="number">1</span>).trim, p(<span class="number">2</span>).trim, p(<span class="number">3</span>).toInt))</span><br><span class="line">    rowRDD.foreach(println)</span><br><span class="line">    <span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">List</span>(</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;id&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">true</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;name&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;gender&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;age&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">true</span>)))</span><br><span class="line">    <span class="keyword">val</span> studentDF=spark.createDataFrame(rowRDD,schema)</span><br><span class="line">    <span class="keyword">val</span> prop = <span class="keyword">new</span> <span class="type">Properties</span>()</span><br><span class="line">    prop.put(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>)</span><br><span class="line">    prop.put(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123&quot;</span>)</span><br><span class="line">    prop.put(<span class="string">&quot;driver&quot;</span>,<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>)</span><br><span class="line">    studentDF.write.mode(<span class="string">&quot;append&quot;</span>).jdbc(<span class="string">&quot;jdbc:mysql://localhost:3306/spark&quot;</span>, <span class="string">&quot;spark.student&quot;</span>, prop)</span><br><span class="line">    jdbcDF.show()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在pom.xml中添加</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>dblab<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-mysql<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.40<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/125.png" alt="1685272619864"></p><p>看到下面有这个就是在下载</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/169.png" alt="1685355010668"></p><p>run一下</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/170.png" alt="1685355401632"></p><h4 id="5-生成应用程序JAR包"><a href="#5-生成应用程序JAR包" class="headerlink" title="5.生成应用程序JAR包"></a>5.生成应用程序JAR包</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/130.png" alt="1685282444814"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/131.png" alt="1685282485542"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/171.png" alt="1685355576293"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/172.png" alt="1685355685885"></p><p>同之前的一样</p><p>只删剩</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/173.png" alt="1685355764997"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/136.png" alt="1685283604818"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/137.png" alt="1685283626589"></p><p>生成的在~&#x2F;IdeaProjects&#x2F;SparkMySQL&#x2F;out&#x2F;artifacts&#x2F;SparkMySQL_jar&#x2F;SparkMySQL.jar中</p><h4 id="6-把JAR包提交到Spark中运行"><a href="#6-把JAR包提交到Spark中运行" class="headerlink" title="6.把JAR包提交到Spark中运行"></a>6.把JAR包提交到Spark中运行</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> cd /usr/local/spark/</span><br><span class="line">./bin/spark-submit --class &quot;SparkOperateMySQL&quot; ~/IdeaProjects/SparkMySQL/out/artifacts/SparkMySQL_jar/SparkMySQL.jar</span><br></pre></td></tr></table></figure><p>成功后如下图</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/174.png" alt="1685356210586"></p><h1 id="十四、使用Spark-MLlib实现协同过滤算法"><a href="#十四、使用Spark-MLlib实现协同过滤算法" class="headerlink" title="十四、使用Spark MLlib实现协同过滤算法"></a>十四、使用Spark MLlib实现协同过滤算法</h1><h4 id="1-在spark-shell中运行ALS算法"><a href="#1-在spark-shell中运行ALS算法" class="headerlink" title="1.在spark-shell中运行ALS算法"></a>1.在spark-shell中运行ALS算法</h4><p>找到Saprk自带的MoveLens数据集</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/spark/data/mllib/als/sample_movielens_data.txt</span><br></pre></td></tr></table></figure><p>使用ALS.train()方法来构建</p><ul><li>引入包</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  org.apache.spark.ml.evaluation.<span class="type">RegressionEvaluator</span></span><br><span class="line"><span class="keyword">import</span>  org.apache.spark.ml.recommendation.<span class="type">ALS</span></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/175.png" alt="1685360157793"></p><ul><li>创建一个Rating类和parseRating函数。</li></ul><p>parseRating函数读取MovieLens数据集中的每一行，并转化成Rating类的对象</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">case</span>  <span class="class"><span class="keyword">class</span>  <span class="title">Rating</span>(<span class="params">userId: <span class="type">Int</span>, movieId: <span class="type">Int</span>, rating: <span class="type">Float</span>, timestamp: <span class="type">Long</span></span>)</span></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/176.png" alt="1685360184128"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span>  <span class="title">parseRating</span></span>(str: <span class="type">String</span>): <span class="type">Rating</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span>  fields = str.split(<span class="string">&quot;::&quot;</span>)</span><br><span class="line">    assert(fields.size == <span class="number">4</span>)</span><br><span class="line">    <span class="type">Rating</span>(fields(<span class="number">0</span>).toInt, fields(<span class="number">1</span>).toInt, fields(<span class="number">2</span>).toFloat, fields(<span class="number">3</span>).toLong)</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/177.png" alt="1685360292549"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  ratings = spark.sparkContext.textFile(<span class="string">&quot;file:///usr/local/spark/data/mllib/als/sample_movielens_ratings.txt&quot;</span>).map(parseRating).toDF()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/178.png" alt="1685360452458"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ratings.show()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/179.png" alt="1685360494208"></p><ul><li>把MovieLens数据集划分训练集和测试集，训练集80%，测试集20%</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  <span class="type">Array</span>(training,test) = ratings.randomSplit(<span class="type">Array</span>(<span class="number">0.8</span>,<span class="number">0.2</span>))</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/180.png" alt="1685360696050"></p><ul><li>使用ALS来建立推荐模型。</li></ul><p>这里构建两个模型，一个是显性反馈，另一个是隐性反馈。</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  alsExplicit = <span class="keyword">new</span> <span class="type">ALS</span>().setMaxIter(<span class="number">5</span>).setRegParam(<span class="number">0.01</span>).setUserCol(<span class="string">&quot;userId&quot;</span>).setItemCol(<span class="string">&quot;movieId&quot;</span>).setRatingCol(<span class="string">&quot;rating&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/181.png" alt="1685360872033"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  alsImplicit = <span class="keyword">new</span> <span class="type">ALS</span>().setMaxIter(<span class="number">5</span>).setRegParam(<span class="number">0.01</span>).setImplicitPrefs(<span class="literal">true</span>).setUserCol(<span class="string">&quot;userId&quot;</span>).setItemCol(<span class="string">&quot;movieId&quot;</span>).setRatingCol(<span class="string">&quot;rating&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/182.png" alt="1685360920841"></p><ul><li>使用训练数据训练推荐模型</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  modelExplicit = alsExplicit.fit(training)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/183.png" alt="1685361134803"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  modelImplicit = alsImplicit.fit(training)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/184.png" alt="1685361165242"></p><ul><li>对测试集中的用户-电影进行预测，的到预测评分的数据集</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  predictionsExplicit= modelExplicit.transform(test).na.drop()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/185.png" alt="1685361468018"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  predictionsImplicit= modelImplicit.transform(test).na.drop()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/186.png" alt="1685361488969"></p><ul><li>输出，对比一下真实结果与预测结果</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">predictionsExplicit.show()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/187.png" alt="1685361695118"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">predictionsImplicit.show()</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/188.png" alt="1685361738211"></p><ul><li>通过计算模型的均方根误差，来对模型进行评估。均匀方根差越小，模型越准确</li></ul><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  evaluator = <span class="keyword">new</span> <span class="type">RegressionEvaluator</span>().setMetricName(<span class="string">&quot;rmse&quot;</span>).setLabelCol(<span class="string">&quot;rating&quot;</span>).setPredictionCol(<span class="string">&quot;prediction&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/189.png" alt="1685361898480"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  rmseExplicit = evaluator.evaluate(predictionsExplicit)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/190.png" alt="1685361952024"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span>  rmseImplicit = evaluator.evaluate(predictionsImplicit)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/191.png" alt="1685361984946"></p><p>&#x2F;&#x2F;打出两个模型的均方根误差</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">println(<span class="string">s&quot;Explicit:Root-mean-square error = <span class="subst">$rmseExplicit</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/192.png" alt="1685362065744"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">println(<span class="string">s&quot;Implicit:Root-mean-square error = <span class="subst">$rmseImplicit</span>&quot;</span>)</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/193.png" alt="1685362121407"></p><h4 id="2-编写独立应用程序运行ALS算法"><a href="#2-编写独立应用程序运行ALS算法" class="headerlink" title="2.编写独立应用程序运行ALS算法"></a>2.编写独立应用程序运行ALS算法</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/194.png" alt="1685366342990"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/195.png" alt="1685375243537"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/117.png" alt="1685271994038"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/118.png" alt="1685272015590"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/119.png" alt="1685272055139"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/120.png" alt="1685272092519"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/121.png" alt="1685272125104"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.sql.<span class="type">SparkSession</span></span><br><span class="line"><span class="keyword">import</span>  org.apache.spark.ml.evaluation.<span class="type">RegressionEvaluator</span></span><br><span class="line"><span class="keyword">import</span>  org.apache.spark.ml.recommendation.<span class="type">ALS</span></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MovieLensALS</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span>  <span class="class"><span class="keyword">class</span>  <span class="title">Rating</span>(<span class="params">userId: <span class="type">Int</span>, movieId: <span class="type">Int</span>, rating: <span class="type">Float</span>, timestamp: <span class="type">Long</span></span>)</span>;</span><br><span class="line">  <span class="function"><span class="keyword">def</span>  <span class="title">parseRating</span></span>(str: <span class="type">String</span>): <span class="type">Rating</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span>  fields = str.split(<span class="string">&quot;::&quot;</span>)</span><br><span class="line">    <span class="type">Rating</span>(fields(<span class="number">0</span>).toInt, fields(<span class="number">1</span>).toInt, fields(<span class="number">2</span>).toFloat, fields(<span class="number">3</span>).toLong)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">      <span class="keyword">val</span> spark=<span class="type">SparkSession</span>.builder().appName(<span class="string">&quot;sparkmllibtest&quot;</span>).master(<span class="string">&quot;local[2]&quot;</span>).getOrCreate()</span><br><span class="line">      <span class="keyword">import</span> spark.implicits._</span><br><span class="line">      <span class="keyword">val</span>  ratings = spark.sparkContext.textFile(<span class="string">&quot;file:///usr/local/spark/data/mllib/als/sample_movielens_ratings.txt&quot;</span>).</span><br><span class="line">         map(parseRating).toDF()</span><br><span class="line">          ratings.show()</span><br><span class="line">      <span class="keyword">val</span>  <span class="type">Array</span>(training,test) = ratings.randomSplit(<span class="type">Array</span>(<span class="number">0.8</span>,<span class="number">0.2</span>))</span><br><span class="line">      <span class="keyword">val</span>  alsExplicit = <span class="keyword">new</span> <span class="type">ALS</span>().setMaxIter(<span class="number">5</span>).setRegParam(<span class="number">0.01</span>).setUserCol(<span class="string">&quot;userId&quot;</span>).setItemCol(<span class="string">&quot;movieId&quot;</span>).setRatingCol(<span class="string">&quot;rating&quot;</span>)</span><br><span class="line">      <span class="keyword">val</span>  alsImplicit = <span class="keyword">new</span> <span class="type">ALS</span>().setMaxIter(<span class="number">5</span>).setRegParam(<span class="number">0.01</span>).setImplicitPrefs(<span class="literal">true</span>).setUserCol(<span class="string">&quot;userId&quot;</span>).setItemCol(<span class="string">&quot;movieId&quot;</span>).setRatingCol(<span class="string">&quot;rating&quot;</span>)</span><br><span class="line">      <span class="keyword">val</span>  modelExplicit = alsExplicit.fit(training)</span><br><span class="line">      <span class="keyword">val</span>  modelImplicit = alsImplicit.fit(training)</span><br><span class="line">      <span class="keyword">val</span>  predictionsExplicit= modelExplicit.transform(test).na.drop()</span><br><span class="line">      <span class="keyword">val</span>  predictionsImplicit= modelImplicit.transform(test).na.drop()</span><br><span class="line">      predictionsExplicit.show()</span><br><span class="line">      predictionsImplicit.show()</span><br><span class="line">      <span class="keyword">val</span>  evaluator = <span class="keyword">new</span> <span class="type">RegressionEvaluator</span>().setMetricName(<span class="string">&quot;rmse&quot;</span>).setLabelCol(<span class="string">&quot;rating&quot;</span>).setPredictionCol(<span class="string">&quot;prediction&quot;</span>)</span><br><span class="line"></span><br><span class="line">      <span class="keyword">val</span>  rmseExplicit = evaluator.evaluate(predictionsExplicit)</span><br><span class="line">      <span class="keyword">val</span>  rmseImplicit = evaluator.evaluate(predictionsImplicit)</span><br><span class="line">      println(<span class="string">s&quot;Explicit:Root-mean-square error = <span class="subst">$rmseExplicit</span>&quot;</span>)</span><br><span class="line">      println(<span class="string">s&quot;Implicit:Root-mean-square error = <span class="subst">$rmseImplicit</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/196.png" alt="1685375773432"></p><p>然后搞pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>dblab<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>SparkALS<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spark.version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">spark.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-sql_2.11 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-mllib_2.11 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-mllib_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-core_2.11 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.alchim31.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scala-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">id</span>&gt;</span>compile-scala<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">id</span>&gt;</span>test-compile-scala<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test-compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>testCompile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">scalaVersion</span>&gt;</span>2.11.8<span class="tag">&lt;/<span class="name">scalaVersion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>自己参照前面的把maven运行一下</p><p>然后</p><p>run那个class文件</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/197+.png" alt="1685376988299"></p><p>成功！</p><p>导出jar文件，参考上面的</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/198.png" alt="1685377096140"></p><p>把jar提交到spark中运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark</span><br><span class="line">./bin/spark-submit --class &quot;MovieLensALS&quot; ~/IdeaProjects/SparkALS/out/artifacts/SparkALS_jar/SparkALS.jar</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/199.png" alt="1685377694946"></p><p>搞定！</p><h1 id="十五、Node-js的安装和使用方法"><a href="#十五、Node-js的安装和使用方法" class="headerlink" title="十五、Node.js的安装和使用方法"></a>十五、Node.js的安装和使用方法</h1><h5 id="1-安装"><a href="#1-安装" class="headerlink" title="1.安装"></a>1.安装</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Downloads</span><br><span class="line">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.33.8/install.sh | bash</span><br></pre></td></tr></table></figure><p>这边需要配置一下host 因为某些不可抗拒因素</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Failed to connect to raw.githubusercontent.com port 443</span><br></pre></td></tr></table></figure><p><strong>查询真实IP</strong></p><p>在<a target="_blank" rel="noopener" href="https://links.jianshu.com/go?to=https://www.ipaddress.com/">https://www.ipaddress.com/</a>查询raw.githubusercontent.com的真实IP。</p><p><strong>修改hosts</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /etc/hosts</span><br></pre></td></tr></table></figure><p>添加如下内容：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">199.232</span>.<span class="number">96.133</span> raw<span class="selector-class">.githubusercontent</span><span class="selector-class">.com</span></span><br></pre></td></tr></table></figure><p>然后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">上面curl的下载完成后</span><br><span class="line">sudo  vim ~/.bashrc</span><br></pre></td></tr></table></figure><p>把下面的写进去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export NVM_DIR=&quot;$HOME/.nvm&quot;</span><br><span class="line">[ -s &quot;$NVM_DIR/nvm.sh&quot; ] &amp;&amp; \. &quot;$NVM_DIR/nvm.sh&quot;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><p>然后下一步</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nvm install --lts</span><br><span class="line">node -v</span><br></pre></td></tr></table></figure><p>会出现这个，因为Ubuntu命令太古老了</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/200.png" alt="1685443698497"></p><p>所以另辟蹊径</p><p>nvm install v12.22.6</p><p>nvm use v12.22.6</p><p>node -v</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/201.png" alt="1685443838168"></p><h4 id="2-应用"><a href="#2-应用" class="headerlink" title="2.应用"></a>2.应用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir mynodeapp</span><br><span class="line">cd mynodeapp</span><br><span class="line">vim server.js</span><br></pre></td></tr></table></figure><p>输入</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> http=<span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line">http.<span class="title function_">createServer</span>(<span class="keyword">function</span> (<span class="params">request,response</span>)&#123;</span><br><span class="line">response.<span class="title function_">writeHead</span>(<span class="number">200</span>,&#123;<span class="string">&#x27;Content-Type&#x27;</span>:<span class="string">&#x27;text/plain&#x27;</span>&#125;);</span><br><span class="line">response.<span class="title function_">end</span>(<span class="string">&#x27;Hello World\n&#x27;</span>);</span><br><span class="line">&#125;).<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server running at http://127.0.0.1:3000/&#x27;</span>);</span><br></pre></td></tr></table></figure><p>保存之后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node server.js</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/202.png" alt="1685444371625"></p><h4 id="3-安装express和Jade"><a href="#3-安装express和Jade" class="headerlink" title="3.安装express和Jade"></a>3.安装express和Jade</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir expressjadeapp</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd expressjadeapp</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd expressjadeapp</span><br><span class="line">npm install express --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd expressjadeapp</span><br><span class="line">npm install jade --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim expressjade.js</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> http=<span class="built_in">require</span>(<span class="string">&#x27;http&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置 Pug（Jade）作为模板引擎</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;jade&#x27;</span>);</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, __dirname);</span><br><span class="line"><span class="comment">// 定义路由和处理程序</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;test&#x27;</span>, &#123; <span class="attr">title</span>: <span class="string">&#x27;Jade test&#x27;</span>,<span class="attr">message</span>:<span class="string">&#x27;Database Lab&#x27;</span> &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> servser=http.<span class="title function_">createServer</span>(app);</span><br><span class="line">servser.<span class="title function_">listen</span>(<span class="number">3000</span>);</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Server running at http://127.0.0.1:3000/&#x27;</span>);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim test.jade</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">	head</span><br><span class="line">		tittle!=tittle</span><br><span class="line">	body</span><br><span class="line">		h1!=message</span><br></pre></td></tr></table></figure><p>然后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node expressjade.js</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/203.png" alt="1685446545268"></p><h4 id="实例1-登陆注册"><a href="#实例1-登陆注册" class="headerlink" title="实例1 登陆注册"></a>实例1 登陆注册</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -u root -p</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create database userlogin;</span><br><span class="line">use userlogin;</span><br><span class="line">create table user (userid int(20) not null auto_increment,username char(50),password char(50),primary key(userid));</span><br><span class="line">desc user;</span><br><span class="line">select * from user;</span><br></pre></td></tr></table></figure><p>创建项目目录</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir userloginapp</span><br><span class="line">cd userloginapp</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure><p>要apt install npm</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install express -save</span><br><span class="line">npm install jade --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mysql --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim userlogin.js</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Created by linziyu on 2018/7/3.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * sexpress接收html传递的参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span>  express=<span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span>  app=<span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">var</span> mysql=<span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 配置MySQL</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">var</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">    host     : <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">    user     : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">    password : <span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">    database : <span class="string">&#x27;userlogin&#x27;</span>,</span><br><span class="line">    <span class="attr">port</span>:<span class="string">&#x27;3306&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line">connection.<span class="title function_">connect</span>();</span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">sendfile</span>(__dirname + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;index.html&quot;</span> );</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现登录验证功能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/login&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span>  name=req.<span class="property">query</span>.<span class="property">name</span>;</span><br><span class="line">    <span class="keyword">var</span> pwd=req.<span class="property">query</span>.<span class="property">pwd</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">var</span> selectSQL = <span class="string">&quot;select * from user where username = &#x27;&quot;</span>+name+<span class="string">&quot;&#x27; and password = &#x27;&quot;</span>+pwd+<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">    connection.<span class="title function_">query</span>(selectSQL,<span class="keyword">function</span> (<span class="params">err,rs</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(rs);</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;OK&#x27;</span>);</span><br><span class="line">        res.<span class="title function_">sendfile</span>(__dirname + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;ok.html&quot;</span> );</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/register.html&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">    res.<span class="title function_">sendfile</span>(__dirname+<span class="string">&quot;/&quot;</span>+<span class="string">&quot;register.html&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 实现注册功能</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/register&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span>  name=req.<span class="property">query</span>.<span class="property">name</span>;</span><br><span class="line">    <span class="keyword">var</span>  pwd=req.<span class="property">query</span>.<span class="property">pwd</span>;</span><br><span class="line">    <span class="keyword">var</span>  user=&#123;<span class="attr">username</span>:name,<span class="attr">password</span>:pwd&#125;;</span><br><span class="line">    connection.<span class="title function_">query</span>(<span class="string">&#x27;insert into user set ?&#x27;</span>,user,<span class="keyword">function</span> (<span class="params">err,rs</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">        res.<span class="title function_">sendfile</span>(__dirname + <span class="string">&quot;/&quot;</span> + <span class="string">&quot;index.html&quot;</span> );</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line">     </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">var</span>  server=app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;userlogin server starts......&quot;</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim index.html</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户登录</span><br><span class="line">        <span class="tag">&lt;<span class="name">form</span>  <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:3000/login&quot;</span>&gt;</span></span><br><span class="line">                User Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">                Password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;register.html&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim register.html</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户注册</span><br><span class="line"><span class="tag">&lt;<span class="name">form</span>  <span class="attr">action</span>=<span class="string">&quot;http://127.0.0.1:3000/register&quot;</span>&gt;</span></span><br><span class="line">   User Name:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;name&quot;</span>/&gt;</span></span><br><span class="line">    Password:<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;pwd&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;提交&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ok.html</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">login success!</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node userlogin.js</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/206.png" alt="1685448718411"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/205.png" alt="1685448694065"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/204.png" alt="1685448654349"></p><h4 id="实例2-用jade实现"><a href="#实例2-用jade实现" class="headerlink" title="实例2 用jade实现"></a>实例2 用jade实现</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir userloginjadeapp</span><br><span class="line">cd userloginjadeapp</span><br><span class="line">npm init</span><br><span class="line">npm install express -save</span><br><span class="line">npm install jade --save</span><br><span class="line">npm install mysql --save</span><br><span class="line">npm install body-parser --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim userloginjade.js</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * Created by linziyu on 2018/7/3.</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * express接收html传递的参数</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">   <span class="keyword">var</span>  express=<span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line">   <span class="keyword">var</span>  bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line">   <span class="keyword">var</span>  app=<span class="title function_">express</span>();</span><br><span class="line">   <span class="keyword">var</span> mysql=<span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line">   app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;jade&#x27;</span>); </span><br><span class="line">   app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, __dirname);</span><br><span class="line">   app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;))</span><br><span class="line">   app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line">    </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 配置MySQL</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   <span class="keyword">var</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">       host     : <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">       user     : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">       password : <span class="string">&#x27;123&#x27;</span>,</span><br><span class="line">       database : <span class="string">&#x27;movierecommend&#x27;</span>,</span><br><span class="line">       <span class="attr">port</span>:<span class="string">&#x27;3306&#x27;</span></span><br><span class="line">   &#125;);</span><br><span class="line">   connection.<span class="title function_">connect</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 跳转到网站首页，也就是用户登录页面</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">       res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">   &#125;)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 实现登录验证功能</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">       <span class="keyword">var</span>  name=req.<span class="property">body</span>.<span class="property">username</span>.<span class="title function_">trim</span>();</span><br><span class="line">       <span class="keyword">var</span> pwd=req.<span class="property">body</span>.<span class="property">pwd</span>.<span class="title function_">trim</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;username:&#x27;</span>+name+<span class="string">&#x27;password:&#x27;</span>+pwd);</span><br><span class="line">    </span><br><span class="line">       <span class="keyword">var</span> selectSQL = <span class="string">&quot;select * from user where username = &#x27;&quot;</span>+name+<span class="string">&quot;&#x27; and password = &#x27;&quot;</span>+pwd+<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">       connection.<span class="title function_">query</span>(selectSQL,<span class="keyword">function</span> (<span class="params">err,rs</span>) &#123;</span><br><span class="line">           <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(rs);</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">           res.<span class="title function_">render</span>(<span class="string">&#x27;ok&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;Welcome User&#x27;</span>,<span class="attr">message</span>:name&#125;);</span><br><span class="line">       &#125;)</span><br><span class="line">   &#125;)</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 跳转到注册页面</span></span><br><span class="line"><span class="comment">    */</span>     </span><br><span class="line">   app.<span class="title function_">get</span>(<span class="string">&#x27;/registerpage&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">     res.<span class="title function_">render</span>(<span class="string">&#x27;registerpage&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;注册&#x27;</span>&#125;);</span><br><span class="line">   &#125;)</span><br><span class="line">    </span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * 实现注册功能</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">   app.<span class="title function_">post</span>(<span class="string">&#x27;/register&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">       <span class="keyword">var</span>  name=req.<span class="property">body</span>.<span class="property">username</span>.<span class="title function_">trim</span>();</span><br><span class="line">       <span class="keyword">var</span>  pwd=req.<span class="property">body</span>.<span class="property">pwd</span>.<span class="title function_">trim</span>();</span><br><span class="line">       <span class="keyword">var</span>  user=&#123;<span class="attr">username</span>:name,<span class="attr">password</span>:pwd&#125;;</span><br><span class="line">       connection.<span class="title function_">query</span>(<span class="string">&#x27;insert into user set ?&#x27;</span>,user,<span class="keyword">function</span> (<span class="params">err,rs</span>) &#123;</span><br><span class="line">           <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;ok&#x27;</span>);</span><br><span class="line">          res.<span class="title function_">render</span>(<span class="string">&#x27;ok&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;Welcome User&#x27;</span>,<span class="attr">message</span>:name&#125;);</span><br><span class="line">       &#125;)</span><br><span class="line">   &#125;)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">   <span class="keyword">var</span>  server=app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">       <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;userloginjade server start......&quot;</span>);</span><br><span class="line">   &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim index.jade</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">      </span><br><span class="line">    form(action=&#x27;/login&#x27;, method=&#x27;post&#x27;)</span><br><span class="line"></span><br><span class="line">      p 用户登录</span><br><span class="line">      input(type=&#x27;text&#x27;,name=&#x27;username&#x27;)</span><br><span class="line">      input(type=&#x27;text&#x27;,name=&#x27;pwd&#x27;)</span><br><span class="line">      input(type=&#x27;submit&#x27;,value=&#x27;登录&#x27;)</span><br><span class="line">      br</span><br><span class="line">    a(href=&#x27;/registerpage&#x27;, title=&#x27;注册&#x27;) 注册</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim registerpage.jade</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line"></span><br><span class="line">    form(action=&#x27;/register&#x27;, method=&#x27;post&#x27;)</span><br><span class="line"></span><br><span class="line">      p 用户注册</span><br><span class="line">      input(type=&#x27;text&#x27;,name=&#x27;username&#x27;)</span><br><span class="line">      input(type=&#x27;text&#x27;,name=&#x27;pwd&#x27;)</span><br><span class="line">      input(type=&#x27;submit&#x27;,value=&#x27;注册&#x27;)</span><br><span class="line">      </span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim ok.jade</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1 热烈欢迎用户: #&#123;message&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>先去mysql里面创建一个movierecommend数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database movierecommend;</span><br><span class="line">use movierecommend;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span> (userid <span class="type">int</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="keyword">null</span> auto_increment,username <span class="type">char</span>(<span class="number">50</span>),password <span class="type">char</span>(<span class="number">50</span>),<span class="keyword">primary</span> key(userid));</span><br><span class="line"><span class="keyword">desc</span> <span class="keyword">user</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="keyword">user</span>;</span><br></pre></td></tr></table></figure><p>然后再</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">node userloginjade.js  </span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/207.png" alt="1685449367685"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/208.png" alt="1685449532848"></p><h4 id="通过网页调用词频统计程序"><a href="#通过网页调用词频统计程序" class="headerlink" title="通过网页调用词频统计程序"></a>通过网页调用词频统计程序</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir myapp</span><br><span class="line">cd myapp</span><br><span class="line">npm init</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/myapp</span><br><span class="line">npm install express -save</span><br><span class="line">npm install jade --save</span><br><span class="line">npm install body-parser --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim index.js</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义路由和处理程序</span></span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.<span class="title function_">send</span>(<span class="string">&#x27;Hello World!&#x27;</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">const</span> servser=app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">const</span> host=servser.<span class="title function_">address</span>().<span class="property">address</span>;</span><br><span class="line">    <span class="keyword">const</span> port=servser.<span class="title function_">address</span>().<span class="property">port</span>;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Listening at http://%:%&#x27;</span>,host,port);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/209.png" alt="1685450260367"></p><p><code>vim index.jade</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">	head</span><br><span class="line">		tittle!=tittle</span><br><span class="line">	body</span><br><span class="line">		h1!=message</span><br></pre></td></tr></table></figure><p>再次修改index.js文件</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="property">exec</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 设置模板引擎</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>,<span class="string">&#x27;./views&#x27;</span>)</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;jade&#x27;</span>)</span><br><span class="line"><span class="comment">// 添加body-parser解析post过来的数据</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;))</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;WordCount测试&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室!&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> path = req.<span class="property">body</span>.<span class="property">path</span>.<span class="title function_">trim</span>()</span><br><span class="line">  <span class="keyword">const</span> jarStr = <span class="string">&#x27;/usr/local/spark/bin/spark-submit --class WordCount ~/IdeaProjects/WordCount/out/artifacts/WordCount_jar/WordCount.jar &#x27;</span>+path+<span class="string">&#x27; /output&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> rmrStr = <span class="string">&#x27;/usr/local/hadoop/bin/hdfs dfs -rmr /output&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> catStr = <span class="string">&#x27;/usr/local/hadoop/bin/hdfs dfs -cat /output/*&#x27;</span></span><br><span class="line">  <span class="title function_">exec</span>(rmrStr,<span class="keyword">function</span>(<span class="params">err, stdout, stderr</span>)&#123;</span><br><span class="line">    <span class="title function_">exec</span>(jarStr, <span class="keyword">function</span>(<span class="params">err, stdout, stderr</span>)&#123;</span><br><span class="line">      <span class="comment">// 判断路径是否存在,如果路径不存在，则显示错误信息</span></span><br><span class="line">      <span class="keyword">if</span>(stderr)&#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;WordCount测试&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室!&#x27;</span>, <span class="attr">result</span>: stderr&#125;)</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">//执行成功后，显示统计结果。</span></span><br><span class="line">      <span class="title function_">exec</span>(catStr,<span class="keyword">function</span>(<span class="params">err, stdout, stderr</span>)&#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;WordCount测试&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室!&#x27;</span>, <span class="attr">result</span>: stdout&#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> server = app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> host = server.<span class="title function_">address</span>().<span class="property">address</span>;</span><br><span class="line">  <span class="keyword">const</span> port = server.<span class="title function_">address</span>().<span class="property">port</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Example app listening at http://%s:%s&#x27;</span>, host, port);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>再改index.jade,并且创建一个views的目录把index.jade移动进去</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir views</span><br><span class="line">mv index.jade ~/myapp/views</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1!= message  </span><br><span class="line">    form(action=&#x27;/&#x27;, method=&#x27;post&#x27;)</span><br><span class="line">      p 请在下面输入所需要进行词频统计文件的路径</span><br><span class="line">      p HDFS文件路径示例：hdfs://localhost:9000/user/hadoop/word.txt</span><br><span class="line">      p 本地文件路径示例：file:///home/hadoop/word.txt</span><br><span class="line">      br</span><br><span class="line">      input(name=&#x27;path&#x27;)</span><br><span class="line">      input(type=&#x27;submit&#x27;)</span><br><span class="line">      br</span><br><span class="line">      textarea(rows=&#x27;40&#x27;, cols=&#x27;40&#x27;)!=result</span><br></pre></td></tr></table></figure><p>搞完之后开启hadoop，hdfs，然后修改WirdCount.jar的内容</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkContext</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkContext</span>._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.<span class="type">SparkConf</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">WordCount</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</span><br><span class="line">    <span class="keyword">val</span> inputFile = args(<span class="number">0</span>)  <span class="comment">//第1个参数是输入文件路径</span></span><br><span class="line">    <span class="keyword">val</span> conf = <span class="keyword">new</span> <span class="type">SparkConf</span>().setAppName(<span class="string">&quot;WordCount&quot;</span>).setMaster(<span class="string">&quot;local&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> sc = <span class="keyword">new</span> <span class="type">SparkContext</span>(conf)</span><br><span class="line">    <span class="keyword">val</span> textFile = sc.textFile(inputFile)</span><br><span class="line">    <span class="keyword">val</span> wordCount = textFile.flatMap(line =&gt; line.split(<span class="string">&quot; &quot;</span>)).map(word =&gt; (word, <span class="number">1</span>)).reduceByKey((a, b) =&gt; a + b)</span><br><span class="line">wordCount.foreach(println)</span><br><span class="line">wordCount.saveAsTextFile(args(<span class="number">1</span>))  <span class="comment">//第2个参数是输出文件路径</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/myapp</span><br><span class="line">node index.js</span><br></pre></td></tr></table></figure><p>这边建议修改一下index.js代码，因为报错包括WARN，所以很难没错</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> exec = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="property">exec</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 设置模板引擎</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>,<span class="string">&#x27;./views&#x27;</span>)</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;jade&#x27;</span>)</span><br><span class="line"><span class="comment">// 添加body-parser解析post过来的数据</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;))</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;WordCount测试&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室!&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> path = req.<span class="property">body</span>.<span class="property">path</span>.<span class="title function_">trim</span>()</span><br><span class="line">  <span class="keyword">const</span> jarStr = <span class="string">&#x27;/usr/local/spark/bin/spark-submit --class WordCount ~/IdeaProjects/WordCount/out/artifacts/WordCount_jar/WordCount.jar &#x27;</span>+path+<span class="string">&#x27; /output&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> rmrStr = <span class="string">&#x27;/usr/local/hadoop/bin/hdfs dfs -rmr /output&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> catStr = <span class="string">&#x27;/usr/local/hadoop/bin/hdfs dfs -cat /output/*&#x27;</span></span><br><span class="line">  <span class="title function_">exec</span>(rmrStr,<span class="keyword">function</span>(<span class="params">err, stdout, stderr</span>)&#123;</span><br><span class="line">    <span class="title function_">exec</span>(jarStr, <span class="keyword">function</span>(<span class="params">err, stdout</span>)&#123;</span><br><span class="line">      <span class="comment">// 判断路径是否存在,如果路径不存在，则显示错误信息</span></span><br><span class="line">      <span class="comment">//执行成功后，显示统计结果。</span></span><br><span class="line">      <span class="title function_">exec</span>(catStr,<span class="keyword">function</span>(<span class="params">err, stdout, stderr</span>)&#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;WordCount测试&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室!&#x27;</span>, <span class="attr">result</span>: stdout&#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> server = app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> host = server.<span class="title function_">address</span>().<span class="property">address</span>;</span><br><span class="line">  <span class="keyword">const</span> port = server.<span class="title function_">address</span>().<span class="property">port</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Example app listening at http://%s:%s&#x27;</span>, host, port);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/210.png" alt="1685452159233"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/211.png" alt="1685463559272"></p><p>这个是测试spark和hdfs连通问题</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">val data = Seq(&quot;Hello&quot;, &quot;World&quot;, &quot;Spark&quot;, &quot;HDFS&quot;)</span><br><span class="line">val rdd = spark.sparkContext.parallelize(data)</span><br><span class="line">rdd.saveAsTextFile(&quot;hdfs://localhost:9000/usr/hadoop/my.txt&quot;)</span><br><span class="line">val rdd = spark.sparkContext.textFile(&quot;hdfs://localhost:9000/usr/hadoop/my.txt&quot;)</span><br><span class="line">rdd.foreach(println)</span><br><span class="line">有输出就是联通的</span><br></pre></td></tr></table></figure><p>解决一个warn警告</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">“WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform” warning</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">配置一下</span><br><span class="line">HADOOP_HOME</span><br><span class="line">检测命令</span><br><span class="line">echo $HADOOP_HOME</span><br></pre></td></tr></table></figure><h1 id="十六、电影推荐系统（基础版）实现过程"><a href="#十六、电影推荐系统（基础版）实现过程" class="headerlink" title="十六、电影推荐系统（基础版）实现过程"></a>十六、电影推荐系统（基础版）实现过程</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Downloads</span><br><span class="line">sudo unzip movie_recommend.zip</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/212.png" alt="1685464042286"></p><h4 id="1-清洗数据"><a href="#1-清洗数据" class="headerlink" title="1.清洗数据"></a>1.清洗数据</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/hadoop</span><br><span class="line">./sbin/start-dfs.sh#启动</span><br><span class="line">#建立一个数据集HDFS目录input_spark</span><br><span class="line">hdfs dfs -mkdir /input_spark</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/213.png" alt="1685464195081"></p><p>把下面俩个导入进hdfs里面</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">file:///home/hadoop/Downloads/movie_recommend/personalRatings.dat </span><br><span class="line">file:///home/hadoop/Downloads/movie_recommend/ratings.dat</span><br></pre></td></tr></table></figure><p>对movie.dat清洗</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/214.png" alt="1685466452270"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/215.png" alt="1685466504655"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/216.png" alt="1685466561456"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/217.png" alt="1685466642348"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/218.png" alt="1685466699402"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/219.png" alt="1685466790159"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/245.png" alt="1685498131672"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/246.png" alt="1685498172429"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/220.png" alt="1685466822014"></p><p>提娜佳剪切字符串控件</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/221.png" alt="1685491556477"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/222.png" alt="1685491610432"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/223.png" alt="1685491657365"></p><p>我打错了应该是dat</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/226.png" alt="1685491922035"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/227.png" alt="1685492017446"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/228.png" alt="1685492061793"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/229.png" alt="1685492351484"></p><p>good game</p><p>查看</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -cat /input_spark/movies.dat | head -5</span><br></pre></td></tr></table></figure><p>乱码也不知道为什么，因为后面不用清洗过的呵呵呵</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/230.png" alt="1685492776500"></p><h4 id="2-编写Spark程序"><a href="#2-编写Spark程序" class="headerlink" title="2.编写Spark程序"></a>2.编写Spark程序</h4><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/160.png" alt="1685353875195"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/161.png" alt="1685353929474"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/231.png" alt="1685493647131"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/164.png" alt="1685354118424"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/165.png" alt="1685354165755"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/166.png" alt="1685354350410"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/167.png" alt="1685354421083"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/233.png" alt="1685494006879"></p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> recommend</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.<span class="type">File</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.&#123;<span class="type">Level</span>, <span class="type">Logger</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.ml.recommendation.&#123;<span class="type">ALS</span>, <span class="type">ALSModel</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.rdd.<span class="type">RDD</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">DataFrame</span>, <span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scala.io.<span class="type">Source</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">MovieLensALS</span> </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Rating</span>(<span class="params">user : <span class="type">Int</span>, product : <span class="type">Int</span>, rating : <span class="type">Double</span></span>)</span></span><br><span class="line">  <span class="keyword">val</span> spark=<span class="type">SparkSession</span>.builder().appName(<span class="string">&quot;MovieLensALS&quot;</span>).master(<span class="string">&quot;local[2]&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">main</span></span>(args: <span class="type">Array</span>[<span class="type">String</span>]) &#123;</span><br><span class="line">    <span class="comment">// 屏蔽不必要的日志显示在终端上</span></span><br><span class="line">    <span class="type">Logger</span>.getLogger(<span class="string">&quot;org.apache.spark&quot;</span>).setLevel(<span class="type">Level</span>.<span class="type">ERROR</span>)</span><br><span class="line">    <span class="type">Logger</span>.getLogger(<span class="string">&quot;org.eclipse.jetty.server&quot;</span>).setLevel(<span class="type">Level</span>.<span class="type">OFF</span>)</span><br><span class="line">    <span class="keyword">if</span> (args.length != <span class="number">5</span>) &#123;</span><br><span class="line">      println(<span class="string">&quot;Usage: /usr/local/spark/bin/spark-submit --class recommend.MovieLensALS &quot;</span> +</span><br><span class="line">        <span class="string">&quot;Spark_Recommend_Dataframe.jar movieLensHomeDir personalRatingsFile bestRank bestLambda bestNumiter&quot;</span>)</span><br><span class="line">      sys.exit(<span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 设置运行环境</span></span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 装载参数二,即用户评分,该评分由评分器生成</span></span><br><span class="line">    <span class="keyword">val</span> myRatings = loadRatings(args(<span class="number">1</span>))</span><br><span class="line">    <span class="keyword">val</span> myRatingsRDD = spark.sparkContext.parallelize(myRatings, <span class="number">1</span>)</span><br><span class="line">    <span class="comment">// 样本数据目录</span></span><br><span class="line">    <span class="keyword">val</span> movieLensHomeDir = args(<span class="number">0</span>)</span><br><span class="line">    <span class="comment">// 装载样本评分数据,其中最后一列 Timestamp 取除 10 的余数作为 key,Rating 为值,即(Int,Rating)</span></span><br><span class="line">    <span class="comment">//ratings.dat 原始数据:用户编号、电影编号、评分、评分时间戳</span></span><br><span class="line">    <span class="keyword">val</span> ratings = spark.sparkContext.textFile(<span class="keyword">new</span> <span class="type">File</span>(movieLensHomeDir,</span><br><span class="line">      <span class="string">&quot;ratings.dat&quot;</span>).toString).map &#123; line =&gt;</span><br><span class="line">      <span class="keyword">val</span> fields = line.split(<span class="string">&quot;::&quot;</span>)</span><br><span class="line">      (fields(<span class="number">3</span>).toLong % <span class="number">10</span>, <span class="type">Rating</span>(fields(<span class="number">0</span>).toInt, fields(<span class="number">1</span>).toInt,</span><br><span class="line">        fields(<span class="number">2</span>).toDouble))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//装载电影目录对照表(电影 ID-&gt;电影标题)</span></span><br><span class="line">    <span class="comment">//movies.dat 原始数据:电影编号、电影名称、电影类别</span></span><br><span class="line">    <span class="keyword">val</span> movies = spark.sparkContext.textFile(<span class="keyword">new</span> <span class="type">File</span>(movieLensHomeDir,</span><br><span class="line">      <span class="string">&quot;movies.dat&quot;</span>).toString).map &#123; line =&gt;</span><br><span class="line">      <span class="keyword">val</span> fields = line.split(<span class="string">&quot;::&quot;</span>)</span><br><span class="line">      (fields(<span class="number">0</span>).toInt, fields(<span class="number">1</span>).toString())</span><br><span class="line">    &#125;.collect().toMap</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> numRatings = ratings.count()</span><br><span class="line">    <span class="keyword">val</span> numUsers = ratings.map(_._2.user).distinct().count()</span><br><span class="line">    <span class="keyword">val</span> numMovies = ratings.map(_._2.product).distinct().count()</span><br><span class="line">    <span class="comment">// 将样本评分表以 key 值切分成 3 个部分,分别用于训练 (60%,并加入用户评分), 校验 (20%), and 测试 (20%)</span></span><br><span class="line">    <span class="comment">// 该数据在计算过程中要多次应用到,所以 cache 到内存</span></span><br><span class="line">    <span class="keyword">val</span> numPartitions = <span class="number">4</span></span><br><span class="line">    <span class="comment">// training 训练样本数据</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> trainingDF = ratings.filter(x =&gt; x._1 &lt; <span class="number">6</span>) <span class="comment">//取评分时间除 10 的余数后值小于 6 的作为训练样本</span></span><br><span class="line">      .values</span><br><span class="line">      .union(myRatingsRDD) <span class="comment">//注意 ratings 是(Int,Rating),取 value 即可</span></span><br><span class="line">      .toDF()</span><br><span class="line">      .repartition(numPartitions)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// validation 校验样本数据</span></span><br><span class="line">    <span class="keyword">val</span> validationDF = ratings.filter(x =&gt; x._1 &gt;= <span class="number">6</span> &amp;&amp; x._1 &lt; <span class="number">8</span>) <span class="comment">//取评分时间除 10 的余数后值大于等于 6 且小于 8 分的作为校验样本</span></span><br><span class="line">      .values</span><br><span class="line">      .toDF()</span><br><span class="line">      .repartition(numPartitions)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// test 测试样本数据</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> testDF = ratings.filter(x =&gt; x._1 &gt;= <span class="number">8</span>).values.toDF() <span class="comment">//取评分时间除 10 的余数后值大于等于 8 分的作为测试样本</span></span><br><span class="line">    <span class="keyword">val</span> numTraining = trainingDF.count()</span><br><span class="line">    <span class="keyword">val</span> numValidation = validationDF.count()</span><br><span class="line">    <span class="keyword">val</span> numTest = testDF.count()</span><br><span class="line">    <span class="comment">// 训练不同参数下的模型,并在校验集中验证,获取最佳参数下的模型</span></span><br><span class="line">    <span class="keyword">val</span> ranks = <span class="type">List</span>(<span class="number">8</span>, <span class="number">12</span>) <span class="comment">//模型中隐语义因子的个数</span></span><br><span class="line">    <span class="keyword">val</span> lambdas = <span class="type">List</span>(<span class="number">0.1</span>, <span class="number">10.0</span>) <span class="comment">//是 ALS 的正则化参数</span></span><br><span class="line">    <span class="keyword">val</span> numIters = <span class="type">List</span>(<span class="number">10</span>, <span class="number">20</span>) <span class="comment">//迭代次数</span></span><br><span class="line">    <span class="keyword">var</span> bestModel: <span class="type">Option</span>[<span class="type">ALSModel</span>] = <span class="type">None</span> <span class="comment">//最好的模型</span></span><br><span class="line">    <span class="keyword">var</span> bestValidationRmse = <span class="type">Double</span>.<span class="type">MaxValue</span> <span class="comment">//最好的校验均方根误差</span></span><br><span class="line">    <span class="keyword">var</span> bestRank = args(<span class="number">2</span>).toInt <span class="comment">//最好的隐语义因子的个数</span></span><br><span class="line">    <span class="keyword">var</span> bestLambda = args(<span class="number">3</span>).toDouble  <span class="comment">//最好的ALS正则化参数</span></span><br><span class="line">    <span class="keyword">var</span> bestNumIter = args(<span class="number">4</span>).toInt  <span class="comment">//最好的迭代次数</span></span><br><span class="line">    <span class="comment">//val model = ALS.train(training, bestRank, bestNumIter, bestLambda) //如果是从外部传入参数，则使用该语句训练模型</span></span><br><span class="line">    <span class="comment">//如果不使用外部传入的参数，而是使用上面定义的ranks、lambdas和numIters的列表值进行模型训练，则使用下面的for循环语句训练模型</span></span><br><span class="line">    <span class="keyword">for</span> (rank &lt;- ranks; lambda &lt;- lambdas; numIter &lt;- numIters) &#123;</span><br><span class="line">      <span class="keyword">val</span> als = <span class="keyword">new</span> <span class="type">ALS</span>().setMaxIter(numIter).setRank(rank).setRegParam(lambda).setUserCol(<span class="string">&quot;user&quot;</span>).setItemCol(<span class="string">&quot;product&quot;</span>).setRatingCol(<span class="string">&quot;rating&quot;</span>)</span><br><span class="line">      <span class="keyword">val</span> model = als.fit(trainingDF)<span class="comment">//训练样本、隐语义因子的个数、迭代次数、ALS 的正则化参数</span></span><br><span class="line">      <span class="comment">// model 训练模型</span></span><br><span class="line">      <span class="comment">//输入训练模型、校验样本、校验个数</span></span><br><span class="line">      <span class="keyword">val</span> validationRmse = computeRmse(model, validationDF, numValidation) <span class="comment">// 校验模型结果</span></span><br><span class="line">      <span class="keyword">if</span> (validationRmse &lt; bestValidationRmse) &#123;</span><br><span class="line">        bestModel = <span class="type">Some</span>(model)</span><br><span class="line">        bestValidationRmse = validationRmse</span><br><span class="line">        bestRank = rank</span><br><span class="line">        bestLambda = lambda</span><br><span class="line">        bestNumIter = numIter</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 用最佳模型预测测试集的评分,并计算和实际评分之间的均方根误差</span></span><br><span class="line">    <span class="keyword">val</span> testRmse = computeRmse(bestModel.get, testDF, numTest)</span><br><span class="line">    <span class="comment">//创建一个基准(Naïve Baseline),并把它和最好的模型进行比较</span></span><br><span class="line">    <span class="keyword">val</span> meanRating = trainingDF.union(validationDF).select(<span class="string">&quot;rating&quot;</span>).rdd.map&#123;<span class="keyword">case</span> <span class="type">Row</span>(v : <span class="type">Double</span>) =&gt; v&#125;.mean</span><br><span class="line">    <span class="keyword">val</span> baselineRmse = math.sqrt(testDF.select(<span class="string">&quot;rating&quot;</span>).rdd.map&#123;<span class="keyword">case</span> <span class="type">Row</span>(v : <span class="type">Double</span>) =&gt; v&#125;.map(x =&gt; (meanRating - x) * (meanRating - x)).mean)</span><br><span class="line">    <span class="comment">//改进了基准的最佳模型</span></span><br><span class="line">    <span class="keyword">val</span> improvement = (baselineRmse - testRmse) / baselineRmse * <span class="number">100</span></span><br><span class="line">    <span class="comment">// 推荐前十部最感兴趣的电影,注意要剔除用户已经评分的电影</span></span><br><span class="line">    <span class="keyword">val</span> myRatedMovieIds = myRatings.map(_.product).toSet</span><br><span class="line"></span><br><span class="line">    <span class="keyword">val</span> candidates = spark.sparkContext.parallelize(movies.keys.filter(!myRatedMovieIds.contains(_)).toSeq).map(<span class="type">Rating</span>(<span class="number">1</span>,_,<span class="number">0.0</span>))</span><br><span class="line">      .toDF().select(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;product&quot;</span>)</span><br><span class="line">    <span class="comment">//上面的Rating(1,_,0.0)中，1表示用户的userid，0.0是赋予的初始评分值，如果为userid为2的用户预测评分值，则需要修改为Rating(2,_,0.0)</span></span><br><span class="line">    <span class="keyword">val</span> recommendations = bestModel.get</span><br><span class="line">      .transform(candidates).select(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;product&quot;</span>,<span class="string">&quot;prediction&quot;</span>).rdd</span><br><span class="line">      .map(x =&gt; <span class="type">Rating</span>(x(<span class="number">0</span>).toString.toInt,x(<span class="number">1</span>).toString.toInt,x(<span class="number">2</span>).toString.toDouble))</span><br><span class="line">      .sortBy(-_.rating)</span><br><span class="line">      .take(<span class="number">10</span>)</span><br><span class="line">    <span class="keyword">var</span> i = <span class="number">1</span></span><br><span class="line">    println(<span class="string">&quot;Movies recommended for you(用户 ID:推荐电影 ID:推荐分数:推荐电影名称):&quot;</span>)</span><br><span class="line">    recommendations.foreach &#123; r =&gt;</span><br><span class="line">      println(r.user + <span class="string">&quot;:&quot;</span> + r.product + <span class="string">&quot;:&quot;</span> + r.rating + <span class="string">&quot;:&quot;</span> + movies(r.product))</span><br><span class="line">      i += <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">    spark.sparkContext.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** 校验集预测数据和实际数据之间的均方根误差 **/</span></span><br><span class="line">  <span class="comment">//输入训练模型、校验样本、校验个数</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">computeRmse</span></span>(model: <span class="type">ALSModel</span>, df: <span class="type">DataFrame</span>, n: <span class="type">Long</span>): <span class="type">Double</span> = &#123;</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line">    <span class="keyword">val</span> predictions = model.transform(df.select(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;product&quot;</span>)) <span class="comment">//调用预测的函数</span></span><br><span class="line">    <span class="comment">// 输出 predictionsAndRatings 预测和评分</span></span><br><span class="line">    <span class="keyword">val</span> predictionsAndRatings = predictions.select(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;product&quot;</span>,<span class="string">&quot;prediction&quot;</span>).rdd.map(x =&gt; ((x(<span class="number">0</span>),x(<span class="number">1</span>)),x(<span class="number">2</span>)))</span><br><span class="line">      .join(df.select(<span class="string">&quot;user&quot;</span>,<span class="string">&quot;product&quot;</span>,<span class="string">&quot;rating&quot;</span>).rdd.map(x =&gt; ((x(<span class="number">0</span>),x(<span class="number">1</span>)),x(<span class="number">2</span>))))</span><br><span class="line">      .values</span><br><span class="line">      .take(<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    math.sqrt(predictionsAndRatings.map(x =&gt; (x._1.toString.toDouble  - x._2.toString.toDouble) * (x._1.toString.toDouble - x._2.toString.toDouble)).reduce(_ + _) / n)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/** 装载用户评分文件 **/</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">loadRatings</span></span>(path: <span class="type">String</span>): <span class="type">Seq</span>[<span class="type">Rating</span>] = &#123;</span><br><span class="line">    <span class="keyword">val</span> lines = <span class="type">Source</span>.fromFile(path).getLines()</span><br><span class="line">    <span class="keyword">val</span> ratings = lines.map &#123; line =&gt;</span><br><span class="line">      <span class="keyword">val</span> fields = line.split(<span class="string">&quot;::&quot;</span>)</span><br><span class="line">      <span class="type">Rating</span>(fields(<span class="number">0</span>).toInt, fields(<span class="number">1</span>).toInt, fields(<span class="number">2</span>).toDouble)</span><br><span class="line">    &#125;.filter(_.rating &gt; <span class="number">0.0</span>)</span><br><span class="line">    <span class="keyword">if</span> (ratings.isEmpty) &#123;</span><br><span class="line">      sys.error(<span class="string">&quot;No ratings provided.&quot;</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      ratings.toSeq</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">groupId</span>&gt;</span>Spark_Recommend_Dataframe<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Spark_Recommend_Dataframe<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">spark.version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">spark.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-sql_2.11 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-mllib_2.11 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-mllib_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-core_2.11 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.alchim31.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scala-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>compile-scala<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">id</span>&gt;</span>test-compile-scala<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test-compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goal</span>&gt;</span>testCompile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">scalaVersion</span>&gt;</span>2.11.8<span class="tag">&lt;/<span class="name">scalaVersion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/234.png" alt="1685494206333"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/235.png" alt="1685494554534"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/236.png" alt="1685494602636"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/237.png" alt="1685494852399"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/240.png" alt="1685495480155"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/238.png" alt="1685494906503"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/241.png" alt="1685495635526"></p><p>运行成功</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/130.png" alt="1685282444814"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/131.png" alt="1685282485542"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/242.png" alt="1685495693374"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/244.png" alt="1685495849116"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/243.png" alt="1685495731256"></p><p>用老图示意一下</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/136.png" alt="1685283604818"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/137.png" alt="1685283626589"></p><p>jar放入spark中运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark/</span><br><span class="line"> ./bin/spark-submit --class recommend.MovieLensALS ~/IdeaProjects/Spark_Recommend_Dataframe/out/artifacts/Spark_Recommend_Dataframe_jar/Spark_Recommend_Dataframe.jar  /input_spark ~/Downloads/personalRatings.dat 10 5 10</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/247.png" alt="1685498468383"></p><p>运行完成</p><h4 id="3-node-js中展示"><a href="#3-node-js中展示" class="headerlink" title="3.node.js中展示"></a>3.node.js中展示</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir mysparkapp</span><br><span class="line">cd mysparkapp</span><br><span class="line">npm init</span><br><span class="line"></span><br><span class="line">npm install express -save</span><br><span class="line">npm install jade --save</span><br><span class="line">npm install body-parser --save</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir views</span><br><span class="line">vim index.js</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> express = <span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> spawnSync = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="property">spawnSync</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">express</span>();</span><br><span class="line"> </span><br><span class="line"><span class="comment">// 设置模板引擎</span></span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>,<span class="string">&#x27;./views&#x27;</span>)</span><br><span class="line">app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;jade&#x27;</span>)</span><br><span class="line"><span class="comment">// 添加body-parser解析post过来的数据</span></span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;))</span><br><span class="line">app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>, <span class="keyword">function</span> (<span class="params">req, res</span>) &#123;</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;电影推荐系统&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室电影推荐系统&#x27;</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line">app.<span class="title function_">post</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span>(<span class="params">req, res</span>)&#123;</span><br><span class="line">  <span class="keyword">const</span> path = req.<span class="property">body</span>.<span class="property">path</span>.<span class="title function_">trim</span>() || <span class="string">&#x27;/input_spark&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> myRatings = req.<span class="property">body</span>.<span class="property">myRatings</span>.<span class="title function_">trim</span>() || <span class="string">&#x27;~/Downloads/personalRatings.dat&#x27;</span></span><br><span class="line">  <span class="keyword">const</span> bestRank = req.<span class="property">body</span>.<span class="property">bestRank</span>.<span class="title function_">trim</span>() || <span class="number">10</span></span><br><span class="line">  <span class="keyword">const</span> bestLambda = req.<span class="property">body</span>.<span class="property">bestLambda</span>.<span class="title function_">trim</span>() || <span class="number">5</span></span><br><span class="line">  <span class="keyword">const</span> bestNumIter = req.<span class="property">body</span>.<span class="property">bestNumIter</span>.<span class="title function_">trim</span>() || <span class="number">10</span></span><br><span class="line">  <span class="keyword">let</span> spark_submit = <span class="title function_">spawnSync</span>(<span class="string">&#x27;/usr/local/spark/bin/spark-submit&#x27;</span>,[<span class="string">&#x27;--class&#x27;</span>, <span class="string">&#x27;recommend.MovieLensALS&#x27;</span>,<span class="string">&#x27; ~/IdeaProjects/Spark_Recommend_Dataframe/out/artifacts/Spark_Recommend_Dataframe_jar/Spark_Recommend_Dataframe.jar&#x27;</span>, path, myRatings, bestRank, bestLambda, bestNumIter],&#123; <span class="attr">shell</span>:<span class="literal">true</span>, <span class="attr">encoding</span>: <span class="string">&#x27;utf8&#x27;</span> &#125;)</span><br><span class="line">  res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;电影推荐系统&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;厦门大学数据库实验室电影推荐系统&#x27;</span>, <span class="attr">result</span>: spark_submit.<span class="property">stdout</span>&#125;)</span><br><span class="line">&#125;)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> server = app.<span class="title function_">listen</span>(<span class="number">3000</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> host = server.<span class="title function_">address</span>().<span class="property">address</span>;</span><br><span class="line">  <span class="keyword">const</span> port = server.<span class="title function_">address</span>().<span class="property">port</span>;</span><br><span class="line"> </span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;Example app listening at http://%s:%s&#x27;</span>, host, port);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd views</span><br><span class="line">vim index.<span class="property">jade</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1!= message  </span><br><span class="line">    <span class="title function_">form</span>(action=<span class="string">&#x27;/&#x27;</span>, method=<span class="string">&#x27;post&#x27;</span>)</span><br><span class="line">      p 请输入建模的相关信息</span><br><span class="line">      <span class="title function_">table</span>(border=<span class="number">0</span>)</span><br><span class="line">        tr</span><br><span class="line">          td 样本数据的路径(默认为/input_spark)</span><br><span class="line">          td </span><br><span class="line">            <span class="title function_">input</span>(style=<span class="string">&#x27;width:350px&#x27;</span>,placeholder=<span class="string">&#x27;/input_spark&#x27;</span>,name=<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line">        tr</span><br><span class="line">          td 用户评分数据的路径(默认为~<span class="regexp">/Downloads/</span>personalRatings.<span class="property">dat</span>)</span><br><span class="line">          td </span><br><span class="line">            <span class="title function_">input</span>(style=<span class="string">&#x27;width:350px&#x27;</span>,placeholder=<span class="string">&#x27;~/Downloads/personalRatings.dat &#x27;</span>,name=<span class="string">&#x27;myRatings&#x27;</span>)    </span><br><span class="line">        tr</span><br><span class="line">          td 隐语义因子的个数：</span><br><span class="line">          td </span><br><span class="line">            <span class="title function_">input</span>(placeholder=<span class="string">&#x27;10&#x27;</span>,type=<span class="string">&#x27;number&#x27;</span>,min=<span class="string">&#x27;8&#x27;</span>,max=<span class="string">&#x27;12&#x27;</span>,name=<span class="string">&#x27;bestRank&#x27;</span>)</span><br><span class="line">        tr</span><br><span class="line">          td 正则化参数：</span><br><span class="line">          td </span><br><span class="line">            <span class="title function_">input</span>(placeholder=<span class="string">&#x27;5&#x27;</span>,type=<span class="string">&#x27;number&#x27;</span>,min=<span class="string">&#x27;0&#x27;</span>,max=<span class="string">&#x27;10&#x27;</span>,step=<span class="string">&#x27;0.1&#x27;</span>,name=<span class="string">&#x27;bestLambda&#x27;</span>)</span><br><span class="line">        tr</span><br><span class="line">          td 迭代次数：</span><br><span class="line">          td </span><br><span class="line">            <span class="title function_">input</span>(placeholder=<span class="string">&#x27;10&#x27;</span>,type=<span class="string">&#x27;number&#x27;</span>,min=<span class="string">&#x27;10&#x27;</span>,max=<span class="string">&#x27;20&#x27;</span>,name=<span class="string">&#x27;bestNumIter&#x27;</span>)            </span><br><span class="line">      <span class="title function_">input</span>(type=<span class="string">&#x27;submit&#x27;</span>)</span><br><span class="line">      br      </span><br><span class="line">      <span class="title function_">textarea</span>(rows=<span class="string">&#x27;20&#x27;</span>, cols=<span class="string">&#x27;40&#x27;</span>)!=result</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd mysparkapp</span><br><span class="line">node index.js</span><br></pre></td></tr></table></figure><h1 id="十七、update"><a href="#十七、update" class="headerlink" title="十七、update"></a>十七、update</h1><p>数据库</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">service mysql start</span><br><span class="line">mysql -u root -p</span><br><span class="line">source ~/Downloads/MovieRecommendDatabase.sql</span><br><span class="line">select count(*) from movieinfo;use movierecommend ;</span><br></pre></td></tr></table></figure><p>idea</p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/248.png" alt="1685500057215"></p><p>和之前步骤一样，最后创建一个recomme文件</p><p>在文件里面创建四个文件</p><p>MovieLensALS</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">package recommend</span><br><span class="line"></span><br><span class="line">import java.io.File</span><br><span class="line">import org.apache.log4j.&#123;Level, Logger&#125;</span><br><span class="line">import org.apache.spark.ml.recommendation.&#123;ALS, ALSModel&#125;</span><br><span class="line">import org.apache.spark.mllib.recommendation.Rating</span><br><span class="line">import org.apache.spark.rdd.RDD</span><br><span class="line">import org.apache.spark.sql.&#123;DataFrame, Row, SparkSession&#125;</span><br><span class="line">import org.apache.spark.&#123;SparkConf, SparkContext&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">object MovieLensALS &#123;</span><br><span class="line">  case class Rating(user : Int, product : Int, rating : Double)</span><br><span class="line">  val spark=SparkSession.builder().appName(&quot;MovieLensALS&quot;).master(&quot;local[2]&quot;).getOrCreate()</span><br><span class="line"></span><br><span class="line">  def main(args: Array[String]) &#123;</span><br><span class="line">    // 屏蔽不必要的日志显示在终端上</span><br><span class="line">    Logger.getLogger(&quot;org.apache.spark&quot;).setLevel(Level.ERROR)</span><br><span class="line">    Logger.getLogger(&quot;org.eclipse.jetty.server&quot;).setLevel(Level.OFF)</span><br><span class="line">    if (args.length != 2) &#123;</span><br><span class="line">      println(&quot;Usage: /usr/local/spark/bin/spark-submit --class recommend.MovieLensALS &quot; +</span><br><span class="line">        &quot;Spark_Recommend_Dataframe.jar movieLensHomeDir userid&quot;)</span><br><span class="line">      sys.exit(1)</span><br><span class="line">    &#125;</span><br><span class="line">    // 设置运行环境</span><br><span class="line">    import spark.implicits._</span><br><span class="line"></span><br><span class="line">    // 装载参数二,即用户评分,该评分由评分器生成</span><br><span class="line">    val userid=args(1).toInt;</span><br><span class="line">    //删除该用户之前已经存在的电影推荐结果，为本次写入最新的推荐结果做准备</span><br><span class="line">    DeleteFromMySQL.delete(userid)</span><br><span class="line">    //从关系数据库中读取该用户对一些电影的个性化评分数据</span><br><span class="line">    val personalRatingsLines:Array[String]=ReadFromMySQL.read(userid)</span><br><span class="line">    val myRatings = loadRatings(personalRatingsLines)</span><br><span class="line">    val myRatingsRDD = spark.sparkContext.parallelize(myRatings, 1)</span><br><span class="line"></span><br><span class="line">    // 样本数据目录</span><br><span class="line">    val movieLensHomeDir = args(0)</span><br><span class="line">    // 装载样本评分数据,其中最后一列 Timestamp 取除 10 的余数作为 key,Rating 为值,即(Int,Rating)</span><br><span class="line">    //ratings.dat 原始数据:用户编号、电影编号、评分、评分时间戳</span><br><span class="line">    val ratings = spark.sparkContext.textFile(new File(movieLensHomeDir,</span><br><span class="line">      &quot;ratings.dat&quot;).toString).map &#123; line =&gt;</span><br><span class="line">      val fields = line.split(&quot;::&quot;)</span><br><span class="line">      (fields(3).toLong % 10, Rating(fields(0).toInt, fields(1).toInt,</span><br><span class="line">        fields(2).toDouble))</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //装载电影目录对照表(电影 ID-&gt;电影标题)</span><br><span class="line">    //movies.dat 原始数据:电影编号、电影名称、电影类别</span><br><span class="line">    val movies = spark.sparkContext.textFile(new File(movieLensHomeDir,</span><br><span class="line">      &quot;movies.dat&quot;).toString).map &#123; line =&gt;</span><br><span class="line">      val fields = line.split(&quot;::&quot;)</span><br><span class="line">      (fields(0).toInt, fields(1).toString())</span><br><span class="line">    &#125;.collect().toMap</span><br><span class="line"></span><br><span class="line">    val numRatings = ratings.count()</span><br><span class="line">    val numUsers = ratings.map(_._2.user).distinct().count()</span><br><span class="line">    val numMovies = ratings.map(_._2.product).distinct().count()</span><br><span class="line">    // 将样本评分表以 key 值切分成 3 个部分,分别用于训练 (60%,并加入用户评分), 校验 (20%), and 测试 (20%)</span><br><span class="line">    // 该数据在计算过程中要多次应用到,所以 cache 到内存</span><br><span class="line">    val numPartitions = 4</span><br><span class="line">    // training 训练样本数据</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    val trainingDF = ratings.filter(x =&gt; x._1 &lt; 6) //取评分时间除 10 的余数后值小于 6 的作为训练样本</span><br><span class="line">      .values</span><br><span class="line">      .union(myRatingsRDD) //注意 ratings 是(Int,Rating),取 value 即可</span><br><span class="line">      .toDF()</span><br><span class="line">      .repartition(numPartitions)</span><br><span class="line"></span><br><span class="line">    // validation 校验样本数据</span><br><span class="line">    val validationDF = ratings.filter(x =&gt; x._1 &gt;= 6 &amp;&amp; x._1 &lt; 8) //取评分时间除 10 的余数后值大于等于 6 且小于 8 分的作为校验样本</span><br><span class="line">      .values</span><br><span class="line">      .toDF()</span><br><span class="line">      .repartition(numPartitions)</span><br><span class="line"></span><br><span class="line">    // test 测试样本数据</span><br><span class="line"></span><br><span class="line">    val testDF = ratings.filter(x =&gt; x._1 &gt;= 8).values.toDF() //取评分时间除 10 的余数后值大于等于 8 分的作为测试样本</span><br><span class="line">    val numTraining = trainingDF.count()</span><br><span class="line">    val numValidation = validationDF.count()</span><br><span class="line">    val numTest = testDF.count()</span><br><span class="line">    // 训练不同参数下的模型,并在校验集中验证,获取最佳参数下的模型</span><br><span class="line">    val ranks = List(8, 12) //模型中隐语义因子的个数</span><br><span class="line">    val lambdas = List(0.1, 10.0) //是 ALS 的正则化参数</span><br><span class="line">    val numIters = List(10, 20) //迭代次数</span><br><span class="line">    var bestModel: Option[ALSModel] = None //最好的模型</span><br><span class="line">    var bestValidationRmse = Double.MaxValue //最好的校验均方根误差</span><br><span class="line">    var bestRank = 0 //最好的隐语义因子的个数</span><br><span class="line">    var bestLambda = 0.0  //最好的ALS正则化参数</span><br><span class="line">    var bestNumIter = 0  //最好的迭代次数</span><br><span class="line">    for (rank &lt;- ranks; lambda &lt;- lambdas; numIter &lt;- numIters) &#123;</span><br><span class="line">      println(&quot;正在执行循环训练模型&quot;)</span><br><span class="line">      val als = new ALS().setMaxIter(numIter).setRank(rank).setRegParam(lambda).setUserCol(&quot;user&quot;).setItemCol(&quot;product&quot;).setRatingCol(&quot;rating&quot;)</span><br><span class="line">      val model = als.fit(trainingDF)//训练样本、隐语义因子的个数、迭代次数、ALS 的正则化参数</span><br><span class="line">      // model 训练模型</span><br><span class="line">      //输入训练模型、校验样本、校验个数</span><br><span class="line">      val validationRmse = computeRmse(model, validationDF, numValidation) // 校验模型结果</span><br><span class="line">      if (validationRmse &lt; bestValidationRmse) &#123;</span><br><span class="line">        bestModel = Some(model)</span><br><span class="line">        bestValidationRmse = validationRmse</span><br><span class="line">        bestRank = rank</span><br><span class="line">        bestLambda = lambda</span><br><span class="line">        bestNumIter = numIter</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 用最佳模型预测测试集的评分,并计算和实际评分之间的均方根误差</span><br><span class="line">    val testRmse = computeRmse(bestModel.get, testDF, numTest)</span><br><span class="line">    //创建一个基准(Naïve Baseline),并把它和最好的模型进行比较</span><br><span class="line">    val meanRating = trainingDF.union(validationDF).select(&quot;rating&quot;).rdd.map&#123;case Row(v : Double) =&gt; v&#125;.mean</span><br><span class="line">    val baselineRmse = math.sqrt(testDF.select(&quot;rating&quot;).rdd.map&#123;case Row(v : Double) =&gt; v&#125;.map(x =&gt; (meanRating - x) * (meanRating - x)).mean)</span><br><span class="line">    //改进了基准的最佳模型</span><br><span class="line">    val improvement = (baselineRmse - testRmse) / baselineRmse * 100</span><br><span class="line">    // 推荐前十部最感兴趣的电影,注意要剔除用户已经评分的电影</span><br><span class="line">    val myRatedMovieIds = myRatings.map(_.product).toSet</span><br><span class="line"></span><br><span class="line">    val candidates = spark.sparkContext.parallelize(movies.keys.filter(!myRatedMovieIds.contains(_)).toSeq).map(Rating(userid,_,0.0))</span><br><span class="line">      .toDF().select(&quot;user&quot;,&quot;product&quot;)</span><br><span class="line">    //上面的Rating(userid,_,0.0)中，0.0是赋予的初始评分值</span><br><span class="line">    val recommendations = bestModel.get</span><br><span class="line">      .transform(candidates).select(&quot;user&quot;,&quot;product&quot;,&quot;prediction&quot;).rdd</span><br><span class="line">      .map(x =&gt; Rating(x(0).toString.toInt,x(1).toString.toInt,x(2).toString.toDouble))</span><br><span class="line">      .sortBy(-_.rating)</span><br><span class="line">      .take(10)</span><br><span class="line">    //把推荐结果写入数据库</span><br><span class="line">    val rddForMySQL=recommendations.map(r=&gt;r.user + &quot;::&quot;+ r.product + &quot;::&quot;+ r.rating+&quot;::&quot; + movies(r.product))</span><br><span class="line">    InsertIntoMySQL.insert(rddForMySQL)</span><br><span class="line">    var i = 1</span><br><span class="line">    println(&quot;Movies recommended for you(用户 ID:推荐电影 ID:推荐分数:推荐电影名称):&quot;)</span><br><span class="line">    recommendations.foreach &#123; r =&gt;</span><br><span class="line">      println(r.user + &quot;:&quot; + r.product + &quot;:&quot; + r.rating + &quot;:&quot; + movies(r.product))</span><br><span class="line">      i += 1</span><br><span class="line">    &#125;</span><br><span class="line">    spark.sparkContext.stop()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /** 校验集预测数据和实际数据之间的均方根误差 **/</span><br><span class="line">  //输入训练模型、校验样本、校验个数</span><br><span class="line">  def computeRmse(model: ALSModel, df: DataFrame, n: Long): Double = &#123;</span><br><span class="line">    import spark.implicits._</span><br><span class="line">    val predictions = model.transform(df.select(&quot;user&quot;,&quot;product&quot;)) //调用预测的函数</span><br><span class="line">    // 输出 predictionsAndRatings 预测和评分</span><br><span class="line">    val predictionsAndRatings = predictions.select(&quot;user&quot;,&quot;product&quot;,&quot;prediction&quot;).rdd.map(x =&gt; ((x(0),x(1)),x(2)))</span><br><span class="line">      .join(df.select(&quot;user&quot;,&quot;product&quot;,&quot;rating&quot;).rdd.map(x =&gt; ((x(0),x(1)),x(2))))</span><br><span class="line">      .values</span><br><span class="line">      .take(10)</span><br><span class="line"></span><br><span class="line">    math.sqrt(predictionsAndRatings.map(x =&gt; (x._1.toString.toDouble  - x._2.toString.toDouble) * (x._1.toString.toDouble - x._2.toString.toDouble)).reduce(_ + _) / n)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  /** 装载用户评分文件 **/</span><br><span class="line">  def loadRatings(lines: Array[String]): Seq[Rating] = &#123;</span><br><span class="line">    val ratings = lines.map &#123; line =&gt;</span><br><span class="line">      val fields = line.split(&quot;::&quot;)</span><br><span class="line">      Rating(fields(0).toInt, fields(1).toInt, fields(2).toDouble)</span><br><span class="line">    &#125;.filter(_.rating &gt; 0.0)</span><br><span class="line">    if (ratings.isEmpty) &#123;</span><br><span class="line">      sys.error(&quot;No ratings provided.&quot;)</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      ratings.toSeq</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>DeleteFromMySQL</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">package recommend</span><br><span class="line">import java.sql.&#123;Connection, DriverManager, PreparedStatement&#125;</span><br><span class="line">import org.apache.spark.sql.&#123;DataFrame, Row, SQLContext&#125;</span><br><span class="line"></span><br><span class="line">object DeleteFromMySQL &#123;</span><br><span class="line"></span><br><span class="line">  val url = &quot;jdbc:mysql://localhost:3306/movierecommend?useUnicode=true&amp;characterEncoding=UTF-8&quot;</span><br><span class="line">  val prop = new java.util.Properties</span><br><span class="line">  prop.setProperty(&quot;user&quot;, &quot;root&quot;)</span><br><span class="line">  prop.setProperty(&quot;password&quot;, &quot;123&quot;)</span><br><span class="line">  def delete(userid:Int): Unit = &#123;</span><br><span class="line">    var conn: Connection = null</span><br><span class="line">    var ps: PreparedStatement = null</span><br><span class="line">    val sql = &quot;delete from recommendresult where userid=&quot;+userid</span><br><span class="line">    conn = DriverManager.getConnection(url,prop)</span><br><span class="line">    ps = conn.prepareStatement(sql)</span><br><span class="line">    ps.executeUpdate()</span><br><span class="line"></span><br><span class="line">    if (ps != null) &#123;</span><br><span class="line">      ps.close()</span><br><span class="line">    &#125;</span><br><span class="line">    if (conn != null) &#123;</span><br><span class="line">      conn.close()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>InsertIntoMySQL</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> recommend</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">Properties</span></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">InsertIntoMySQL</span></span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">insert</span></span>(array:<span class="type">Array</span>[<span class="type">String</span>]): <span class="type">Unit</span> = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark= <span class="type">SparkSession</span>.builder().appName(<span class="string">&quot;InsertIntoMySQL&quot;</span>).master(<span class="string">&quot;local[2]&quot;</span>).getOrCreate()</span><br><span class="line">    <span class="keyword">val</span> movieRDD = spark.sparkContext.parallelize(array).map(_.split(<span class="string">&quot;::&quot;</span>))</span><br><span class="line">    <span class="keyword">val</span> rowRDD = movieRDD.map(p =&gt; <span class="type">Row</span>(p(<span class="number">0</span>).trim.toInt, p(<span class="number">1</span>).trim.toInt, p(<span class="number">2</span>).trim.toFloat, p(<span class="number">3</span>).trim))</span><br><span class="line">    rowRDD.foreach(println)</span><br><span class="line">    <span class="keyword">val</span> schema = <span class="type">StructType</span>(<span class="type">List</span>(</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;userid&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">true</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;movieid&quot;</span>, <span class="type">IntegerType</span>, <span class="literal">true</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;rating&quot;</span>, <span class="type">FloatType</span>, <span class="literal">true</span>),</span><br><span class="line">      <span class="type">StructField</span>(<span class="string">&quot;moviename&quot;</span>, <span class="type">StringType</span>, <span class="literal">true</span>)))</span><br><span class="line">    <span class="keyword">val</span> movieDF=spark.createDataFrame(rowRDD,schema)</span><br><span class="line">    <span class="keyword">val</span> prop = <span class="keyword">new</span> <span class="type">Properties</span>()</span><br><span class="line">    prop.put(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>)</span><br><span class="line">    prop.put(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123&quot;</span>)</span><br><span class="line">    prop.put(<span class="string">&quot;driver&quot;</span>,<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>)</span><br><span class="line">    movieDF.write.mode(<span class="string">&quot;append&quot;</span>).jdbc(<span class="string">&quot;jdbc:mysql://localhost:3306/movierecommend&quot;</span>, <span class="string">&quot;movierecommend.recommendresult&quot;</span>, prop)</span><br><span class="line">    movieDF.show()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ReadFromMySQL</p><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> recommend</span><br><span class="line"><span class="keyword">import</span> java.util.<span class="type">Properties</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.types._</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.sql.&#123;<span class="type">Row</span>, <span class="type">SparkSession</span>&#125;</span><br><span class="line"><span class="keyword">import</span> org.apache.spark.&#123;<span class="type">SparkConf</span>, <span class="type">SparkContext</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> scala.collection.mutable.<span class="type">ArrayBuffer</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">ReadFromMySQL</span></span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">read</span></span>(userid:<span class="type">Int</span>): <span class="type">Array</span>[<span class="type">String</span>] = &#123;</span><br><span class="line">    <span class="keyword">val</span> spark= <span class="type">SparkSession</span>.builder().appName(<span class="string">&quot;ReadFromMySQL&quot;</span>).master(<span class="string">&quot;local[2]&quot;</span>).getOrCreate()</span><br><span class="line">    <span class="keyword">import</span> spark.implicits._</span><br><span class="line">    <span class="keyword">val</span> personalRatingsDF = spark.</span><br><span class="line">      read.format(<span class="string">&quot;jdbc&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;url&quot;</span>, <span class="string">&quot;jdbc:mysql://localhost:3306/movierecommend&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;driver&quot;</span>,<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;dbtable&quot;</span>, <span class="string">&quot;personalratings&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;root&quot;</span>).</span><br><span class="line">      option(<span class="string">&quot;password&quot;</span>, <span class="string">&quot;123&quot;</span>).load()</span><br><span class="line">    personalRatingsDF.show()</span><br><span class="line">    personalRatingsDF.createOrReplaceTempView(<span class="string">&quot;personalratings&quot;</span>)</span><br><span class="line">    <span class="keyword">val</span> prDF=spark.sql(<span class="string">&quot;select * from personalratings where userid=&quot;</span>+userid)</span><br><span class="line">    <span class="keyword">val</span> myrdd=prDF.rdd.map(r=&gt;&#123;r(<span class="number">0</span>).toString+<span class="string">&quot;::&quot;</span>+r(<span class="number">1</span>).toString+<span class="string">&quot;::&quot;</span>+r(<span class="number">2</span>).toString+<span class="string">&quot;::&quot;</span>+r(<span class="number">3</span>).toString&#125;)</span><br><span class="line">    <span class="keyword">val</span> array=<span class="type">ArrayBuffer</span>[<span class="type">String</span>]()</span><br><span class="line">    array++=myrdd.collect();</span><br><span class="line">    println(array.length)</span><br><span class="line">    <span class="keyword">val</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (i &lt;- <span class="number">0</span> until array.length)&#123;println(array(i))&#125;</span><br><span class="line">    array.toArray</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>pom.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">project</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">modelVersion</span>&gt;</span>4.0.0<span class="tag">&lt;/<span class="name">modelVersion</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>Film_Recommend_Dataframe<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>Film_Recommend_Dataframe<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">spark.version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">spark.version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-mllib_2.11 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-mllib_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.spark/spark-core_2.11 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-core_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spark.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.spark<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spark-sql_2.11<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.40<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.apache.hadoop/hadoop-yarn-common --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.hadoop<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hadoop-yarn-common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">build</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">plugins</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>net.alchim31.maven<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>scala-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">id</span>&gt;</span>compile-scala<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">id</span>&gt;</span>test-compile-scala<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">phase</span>&gt;</span>test-compile<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>add-source<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">goal</span>&gt;</span>testCompile<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">scalaVersion</span>&gt;</span>2.11.8<span class="tag">&lt;/<span class="name">scalaVersion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">plugins</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">build</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">project</span>&gt;</span></span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/249.png" alt="1685501301214"></p><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/250.png" alt="1685501677945"></p><p>打包jar</p><p>运行</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/spark/</span><br><span class="line">./bin/spark-submit --class recommend.MovieLensALS ~/IdeaProjects/Film_Recommend_Dataframe/out/artifacts/Film_Recommend_Dataframe_jar/Film_Recommend_Dataframe.jar /input_spark 1</span><br></pre></td></tr></table></figure><p><img src="/images/loading.gif" data-original="/images/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/256.png" alt="1685502183115"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd ~</span><br><span class="line">mkdir movierecommendapp</span><br><span class="line">cd  movierecommendapp</span><br><span class="line">npm install express -save</span><br><span class="line">npm install jade --save</span><br><span class="line">npm install body-parser --save</span><br><span class="line">npm install mysql --save</span><br></pre></td></tr></table></figure><p>vim movierecommend.js</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Created by linziyu on 2018/7/3.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * express接收html传递的参数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     </span><br><span class="line">    <span class="keyword">var</span>  express=<span class="built_in">require</span>(<span class="string">&#x27;express&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span>  bodyParser = <span class="built_in">require</span>(<span class="string">&#x27;body-parser&#x27;</span>)</span><br><span class="line">    <span class="keyword">const</span> spawnSync = <span class="built_in">require</span>(<span class="string">&#x27;child_process&#x27;</span>).<span class="property">spawnSync</span>;</span><br><span class="line">    <span class="keyword">var</span>  app=<span class="title function_">express</span>();</span><br><span class="line">    <span class="keyword">var</span> mysql=<span class="built_in">require</span>(<span class="string">&#x27;mysql&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line">    app.<span class="title function_">set</span>(<span class="string">&#x27;view engine&#x27;</span>, <span class="string">&#x27;jade&#x27;</span>); </span><br><span class="line">    app.<span class="title function_">set</span>(<span class="string">&#x27;views&#x27;</span>, <span class="string">&#x27;./views&#x27;</span>);</span><br><span class="line">    app.<span class="title function_">use</span>(bodyParser.<span class="title function_">urlencoded</span>(&#123;<span class="attr">extended</span>: <span class="literal">false</span>&#125;))</span><br><span class="line">    app.<span class="title function_">use</span>(bodyParser.<span class="title function_">json</span>())</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 配置MySQL</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">var</span> connection = mysql.<span class="title function_">createConnection</span>(&#123;</span><br><span class="line">        host     : <span class="string">&#x27;127.0.0.1&#x27;</span>,</span><br><span class="line">        user     : <span class="string">&#x27;root&#x27;</span>,</span><br><span class="line">        password : <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">        database : <span class="string">&#x27;movierecommend&#x27;</span>,</span><br><span class="line">        <span class="attr">port</span>:<span class="string">&#x27;3306&#x27;</span></span><br><span class="line">    &#125;);</span><br><span class="line">    connection.<span class="title function_">connect</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 跳转到网站首页</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    app.<span class="title function_">get</span>(<span class="string">&#x27;/&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">        res.<span class="title function_">render</span>(<span class="string">&#x27;index&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 跳转到登录页面</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    app.<span class="title function_">get</span>(<span class="string">&#x27;/loginpage&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">      res.<span class="title function_">render</span>(<span class="string">&#x27;loginpage&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;登录&#x27;</span>&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 实现登录验证功能</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    app.<span class="title function_">post</span>(<span class="string">&#x27;/login&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span>  name=req.<span class="property">body</span>.<span class="property">username</span>.<span class="title function_">trim</span>();</span><br><span class="line">        <span class="keyword">var</span> pwd=req.<span class="property">body</span>.<span class="property">pwd</span>.<span class="title function_">trim</span>();</span><br><span class="line">	<span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;username:&#x27;</span>+name+<span class="string">&#x27;password:&#x27;</span>+pwd);</span><br><span class="line">        <span class="keyword">var</span> selectMovieInfoSQL=<span class="string">&quot;select movieid,moviename,picture from movieinfo limit 1000&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> movieinfolist=[];</span><br><span class="line">	connection.<span class="title function_">query</span>(selectMovieInfoSQL,<span class="keyword">function</span>(<span class="params">err,rows,fields</span>)&#123;</span><br><span class="line">	   <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">	   <span class="comment">//console.log(&#x27;movieids length is:&#x27;+rows.length);</span></span><br><span class="line">	   <span class="comment">//console.log(&#x27;movieid is:&#x27;+rows[0].movieid);</span></span><br><span class="line">           <span class="comment">//console.log(&#x27;moviename is:&#x27;+rows[0].moviename);</span></span><br><span class="line">           movieinfolist=rows;</span><br><span class="line">           &#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> selectSQL = <span class="string">&quot;select * from user where username = &#x27;&quot;</span>+name+<span class="string">&quot;&#x27; and password = &#x27;&quot;</span>+pwd+<span class="string">&quot;&#x27;&quot;</span>;</span><br><span class="line">        connection.<span class="title function_">query</span>(selectSQL,<span class="keyword">function</span> (<span class="params">err,rows,fields</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">            <span class="keyword">function</span> <span class="title function_">randomFrom</span>(<span class="params">lowerValue,upperValue</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (upperValue - lowerValue + <span class="number">1</span>) + lowerValue);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//console.log(&#x27;userid is:&#x27;+rows[0].userid);</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> lowerValue=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">var</span> upperValue=movieinfolist.<span class="property">length</span>;</span><br><span class="line">            <span class="keyword">var</span> index=<span class="title function_">randomFrom</span>(lowerValue,upperValue);</span><br><span class="line">            <span class="comment">//console.log(&#x27;movieid random is:&#x27;+movieinfolist[index].movieid);</span></span><br><span class="line">            <span class="comment">//console.log(&#x27;moviename random is:&#x27;+movieinfolist[index].moviename);</span></span><br><span class="line">            <span class="keyword">var</span> movielist=[];</span><br><span class="line">            <span class="keyword">var</span> movieNumbers=<span class="number">10</span>;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;movieNumbers;i++)&#123;</span><br><span class="line">              index=<span class="title function_">randomFrom</span>(lowerValue,upperValue);</span><br><span class="line">              movielist.<span class="title function_">push</span>(&#123;<span class="attr">movieid</span>:movieinfolist[index].<span class="property">movieid</span>,<span class="attr">moviename</span>:movieinfolist[index].<span class="property">moviename</span>,<span class="attr">picture</span>:movieinfolist[index].<span class="property">picture</span>&#125;);</span><br><span class="line">              </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//for(var item in movielist)&#123;</span></span><br><span class="line">            <span class="comment">//  console.log(&#x27;item is:&#x27;+item);</span></span><br><span class="line">            <span class="comment">//  console.log(&#x27;movieid is:&#x27;+movielist[item].movieid);</span></span><br><span class="line">            <span class="comment">//  console.log(&#x27;moviename is:&#x27;+movielist[item].moviename);</span></span><br><span class="line">            <span class="comment">//&#125;</span></span><br><span class="line">                       </span><br><span class="line">            res.<span class="title function_">render</span>(<span class="string">&#x27;personalratings&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;Welcome User&#x27;</span>,<span class="attr">userid</span>:rows[<span class="number">0</span>].<span class="property">userid</span>,<span class="attr">username</span>:rows[<span class="number">0</span>].<span class="property">username</span>,<span class="attr">movieforpage</span>:movielist&#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 跳转到注册页面</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     </span><br><span class="line">    app.<span class="title function_">get</span>(<span class="string">&#x27;/registerpage&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">      res.<span class="title function_">render</span>(<span class="string">&#x27;registerpage&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;注册&#x27;</span>&#125;);</span><br><span class="line">    &#125;)</span><br><span class="line">     </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 实现注册功能</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    app.<span class="title function_">post</span>(<span class="string">&#x27;/register&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span>  name=req.<span class="property">body</span>.<span class="property">username</span>.<span class="title function_">trim</span>();</span><br><span class="line">        <span class="keyword">var</span>  pwd=req.<span class="property">body</span>.<span class="property">pwd</span>.<span class="title function_">trim</span>();</span><br><span class="line">        <span class="keyword">var</span>  user=&#123;<span class="attr">username</span>:name,<span class="attr">password</span>:pwd&#125;;</span><br><span class="line">        connection.<span class="title function_">query</span>(<span class="string">&#x27;insert into user set ?&#x27;</span>,user,<span class="keyword">function</span> (<span class="params">err,rs</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;register success&#x27;</span>);</span><br><span class="line">           res.<span class="title function_">render</span>(<span class="string">&#x27;registersuccess&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;注册成功&#x27;</span>,<span class="attr">message</span>:name&#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 把用户评分写入数据库</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     </span><br><span class="line">    app.<span class="title function_">post</span>(<span class="string">&#x27;/submituserscore&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span>  userid=req.<span class="property">body</span>.<span class="property">userid</span>;</span><br><span class="line">        <span class="keyword">var</span> moviescores=[];</span><br><span class="line">        <span class="keyword">var</span> movieids=[];</span><br><span class="line">        req.<span class="property">body</span>.<span class="property">moviescore</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">score</span>)&#123;</span><br><span class="line">            <span class="comment">//console.log(&#x27;the score is:&#x27;+score);</span></span><br><span class="line">            moviescores.<span class="title function_">push</span>(&#123;<span class="attr">moviescore</span>:score&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        req.<span class="property">body</span>.<span class="property">movieid</span>.<span class="title function_">forEach</span>(<span class="keyword">function</span>(<span class="params">id</span>)&#123;</span><br><span class="line">            <span class="comment">//console.log(&#x27;the id is:&#x27;+id);</span></span><br><span class="line">            movieids.<span class="title function_">push</span>(&#123;<span class="attr">movieid</span>:id&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//for(var item in movieids)&#123;</span></span><br><span class="line">        <span class="comment">//   console.log(&#x27;item is:&#x27;+item);</span></span><br><span class="line">        <span class="comment">//   console.log(&#x27;movieid is:&#x27;+movieids[item].movieid);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//for(var item in moviescores)&#123;</span></span><br><span class="line">        <span class="comment">//   console.log(&#x27;item is:&#x27;+item);</span></span><br><span class="line">        <span class="comment">//   console.log(&#x27;moviescore is:&#x27;+moviescores[item].moviescore);</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        <span class="comment">//删除该用户历史评分数据，为写入本次最新评分数据做准备</span></span><br><span class="line">        connection.<span class="title function_">query</span>(<span class="string">&#x27;delete from  personalratings where userid=&#x27;</span>+userid, <span class="keyword">function</span>(<span class="params">err, result</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;deleted&#x27;</span>);</span><br><span class="line">            <span class="comment">//console.log(result);</span></span><br><span class="line">            <span class="comment">//console.log(&#x27;\n&#x27;);</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="comment">//生成评分时间戳</span></span><br><span class="line">        <span class="keyword">var</span> mytimestamp =<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>().<span class="title function_">toString</span>().<span class="title function_">slice</span>(<span class="number">1</span>,<span class="number">10</span>);        </span><br><span class="line">        <span class="comment">//console.log(&#x27;mytimestamp2 is:&#x27;+mytimestamp);</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">var</span> item <span class="keyword">in</span> movieids)&#123;</span><br><span class="line">           <span class="comment">//把每条评分记录(userid,movieid,rating,timestamp)插入数据库  </span></span><br><span class="line">           <span class="keyword">var</span> personalratings=&#123;<span class="attr">userid</span>:userid,<span class="attr">movieid</span>:movieids[item].<span class="property">movieid</span>,<span class="attr">rating</span>:moviescores[item].<span class="property">moviescore</span>,<span class="attr">timestamp</span>:mytimestamp&#125;;</span><br><span class="line">           connection.<span class="title function_">query</span>(<span class="string">&#x27;insert into personalratings set ?&#x27;</span>,personalratings,<span class="keyword">function</span> (<span class="params">err,rs</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;insert into personalrating success&#x27;</span>);          </span><br><span class="line">           &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">var</span> selectUserIdNameSQL=<span class="string">&#x27;select userid,username from user where userid=&#x27;</span>+userid;</span><br><span class="line">        connection.<span class="title function_">query</span>(selectUserIdNameSQL,<span class="keyword">function</span>(<span class="params">err,rows,fields</span>)&#123;</span><br><span class="line">           <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">           res.<span class="title function_">render</span>(<span class="string">&#x27;userscoresuccess&#x27;</span>,&#123;<span class="attr">title</span>:<span class="string">&#x27;Personal Rating Success&#x27;</span>,<span class="attr">user</span>:rows[<span class="number">0</span>]&#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    </span><br><span class="line">    &#125;); </span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 调用Spark程序为用户推荐电影并把推荐结果写入数据库,把推荐结果显示到网页</span></span><br><span class="line"><span class="comment">     */</span>     </span><br><span class="line">    app.<span class="title function_">get</span>(<span class="string">&#x27;/recommendmovieforuser&#x27;</span>,<span class="keyword">function</span> (<span class="params">req,res</span>) &#123;</span><br><span class="line">	<span class="comment">//console.log(&#x27;result point 1&#x27;);</span></span><br><span class="line">        <span class="keyword">const</span> userid=req.<span class="property">query</span>.<span class="property">userid</span>;</span><br><span class="line">        <span class="keyword">const</span> username=req.<span class="property">query</span>.<span class="property">username</span>;</span><br><span class="line">        <span class="comment">//console.log(&#x27;recommendation userid is:&#x27;+userid);      </span></span><br><span class="line">        <span class="keyword">const</span> path = <span class="string">&#x27;/input_spark&#x27;</span>;</span><br><span class="line">        <span class="comment">//调用Spark程序为用户推荐电影并把推荐结果写入数据库</span></span><br><span class="line">        <span class="keyword">let</span> spark_submit = <span class="title function_">spawnSync</span>(<span class="string">&#x27;/usr/local/spark/bin/spark-submit&#x27;</span>,[<span class="string">&#x27;--class&#x27;</span>, <span class="string">&#x27;recommend.MovieLensALS&#x27;</span>,<span class="string">&#x27; ~/IdeaProjects/Film_Recommend/out/artifacts/Film_Recommend_jar/Film_Recommend.jar&#x27;</span>, path, userid],&#123; <span class="attr">shell</span>:<span class="literal">true</span>, <span class="attr">encoding</span>: <span class="string">&#x27;utf8&#x27;</span> &#125;);</span><br><span class="line">        <span class="comment">//console.log(&#x27;spark running result is:&#x27;+spark_submit.stdout);</span></span><br><span class="line">        <span class="comment">//从数据库中读取推荐结果,把推荐结果显示到网页</span></span><br><span class="line">        <span class="keyword">var</span> selectRecommendResultSQL=<span class="string">&quot;select recommendresult.userid,recommendresult.movieid,recommendresult.rating,recommendresult.moviename,movieinfo.picture from recommendresult inner join movieinfo on recommendresult.movieid=movieinfo.movieid where recommendresult.userid=&quot;</span>+userid;</span><br><span class="line">        <span class="keyword">var</span> movieinfolist=[];</span><br><span class="line">        connection.<span class="title function_">query</span>(selectRecommendResultSQL,<span class="keyword">function</span>(<span class="params">err,rows,fields</span>)&#123;</span><br><span class="line">           <span class="keyword">if</span> (err) <span class="keyword">throw</span>  err;</span><br><span class="line">           <span class="comment">//console.log(&#x27;result point 3&#x27;);</span></span><br><span class="line">           <span class="comment">//console.log(&#x27;movieids length is:&#x27;+rows.length);</span></span><br><span class="line">           <span class="comment">//console.log(&#x27;movieid is:&#x27;+rows[0].movieid);</span></span><br><span class="line">           <span class="comment">//console.log(&#x27;moviename is:&#x27;+rows[0].moviename);</span></span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;read recommend result from database&#x27;</span>);</span><br><span class="line">           </span><br><span class="line">           <span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;rows.<span class="property">length</span>;i++)&#123;</span><br><span class="line">              <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;forxunhuan:i=&#x27;</span>+i);</span><br><span class="line">              movieinfolist.<span class="title function_">push</span>(&#123;<span class="attr">userid</span>:rows[i].<span class="property">userid</span>,<span class="attr">movieid</span>:rows[i].<span class="property">movieid</span>,<span class="attr">rating</span>:rows[i].<span class="property">rating</span>,<span class="attr">moviename</span>:rows[i].<span class="property">moviename</span>,<span class="attr">picture</span>:rows[i].<span class="property">picture</span>&#125;);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           <span class="comment">//for(var item in movieinfolist)&#123;</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;result point 6&#x27;);</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;item is:&#x27;+item);</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;userid is:&#x27;+movieinfolist[item].userid);</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;movieid is:&#x27;+movieinfolist[item].movieid);</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;moviename is:&#x27;+movieinfolist[item].moviename);</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;rating is:&#x27;+movieinfolist[item].rating);</span></span><br><span class="line">           <span class="comment">//   console.log(&#x27;picture is:&#x27;+movieinfolist[item].picture);</span></span><br><span class="line">           <span class="comment">//&#125;</span></span><br><span class="line"></span><br><span class="line">           res.<span class="title function_">render</span>(<span class="string">&#x27;recommendresult&#x27;</span>, &#123;<span class="attr">title</span>: <span class="string">&#x27;Recommend Result&#x27;</span>, <span class="attr">message</span>: <span class="string">&#x27;this is recommend for you&#x27;</span>,<span class="attr">username</span>:username,<span class="attr">movieinfo</span>:movieinfolist&#125;)</span><br><span class="line">           &#125;);</span><br><span class="line"></span><br><span class="line">    &#125;)    </span><br><span class="line"> </span><br><span class="line">    <span class="keyword">var</span>  server=app.<span class="title function_">listen</span>(<span class="number">3000</span>,<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;movierecommend server start......&quot;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir views</span><br><span class="line">cd views</span><br></pre></td></tr></table></figure><p>vim index.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!=title    </span><br><span class="line">    meta(charset=&#x27;utf-8&#x27;)</span><br><span class="line">    meta(name=&#x27;description&#x27;)</span><br><span class="line">    meta(name=&#x27;keywords&#x27;)</span><br><span class="line">    meta(name=&#x27;author&#x27;)</span><br><span class="line">    link(rel=&#x27;shortcut icon&#x27;, href=&#x27;http://eduppp.cn/images/logo4.gif&#x27;)</span><br><span class="line">    link(rel=&#x27;apple-touch-icon&#x27;, href=&#x27;http://eduppp.cn/images/logo.gif&#x27;)</span><br><span class="line">    style</span><br><span class="line">      include css/index.css</span><br><span class="line">    style(type=&#x27;text/css&#x27;).</span><br><span class="line">      #frame &#123;/*----------图片轮播相框容器----------*/</span><br><span class="line">      position: absolute; /*--绝对定位，方便子元素的定位*/</span><br><span class="line">      width: 1500px;</span><br><span class="line">      height: 75%;</span><br><span class="line">      overflow: hidden;/*--相框作用，只显示一个图片---*/</span><br><span class="line">      border-radius:5px;</span><br><span class="line">      &#125;</span><br><span class="line">      #dis &#123;/*--绝对定位方便li图片简介的自动分布定位---*/</span><br><span class="line">      position: absolute;</span><br><span class="line">      left: -50px;</span><br><span class="line">      top: -10px;</span><br><span class="line">      opacity: 0.5;</span><br><span class="line">      &#125;</span><br><span class="line">      #dis li &#123;</span><br><span class="line">      display: inline-block;</span><br><span class="line">      width: 200px;</span><br><span class="line">      height: 20px;</span><br><span class="line">      margin: 0 650px;</span><br><span class="line">      float: left;</span><br><span class="line">      text-align: center;</span><br><span class="line">      color: #fff;</span><br><span class="line">      border-radius: 10px;</span><br><span class="line">      background: #000;</span><br><span class="line">      &#125;</span><br><span class="line">      #photos img &#123;</span><br><span class="line">      float: left;</span><br><span class="line">      width:1500px;</span><br><span class="line">      height:75%;</span><br><span class="line">      &#125;</span><br><span class="line">      #photos &#123;/*---设置总的图片宽度--通过位移来达到轮播效果----*/</span><br><span class="line">      position: absolute;z-index:9px;</span><br><span class="line">      width: calc(1500px * 5);/*---修改图片数量的话需要修改下面的动画参数*/</span><br><span class="line">      &#125;</span><br><span class="line">      .play&#123;</span><br><span class="line">      animation: ma 20s ease-out infinite alternate;/**/</span><br><span class="line">      &#125;</span><br><span class="line">      @keyframes ma &#123;/*---每图片切换有两个阶段：位移切换和静置。中间的效果可以任意定制----*/</span><br><span class="line">      0%,20% &#123;		margin-left: 0px;		&#125;</span><br><span class="line">      25%,40% &#123;		margin-left: -1500px;	&#125;</span><br><span class="line">      45%,60% &#123;		margin-left: -3000px;	&#125;</span><br><span class="line">      65%,80% &#123;		margin-left: -4500px;	&#125;</span><br><span class="line">      85%,100% &#123;		margin-left: -6000px;	&#125;</span><br><span class="line">      &#125;</span><br><span class="line">      .num&#123;</span><br><span class="line">      position:absolute;z-index:10;</span><br><span class="line">      display:inline-block;</span><br><span class="line">      right:10px;top:550px;</span><br><span class="line">      border-radius:100%;</span><br><span class="line">      background:#778899;</span><br><span class="line">      width:50px;height:50px;</span><br><span class="line">      line-height:50px;</span><br><span class="line">      cursor:pointer;</span><br><span class="line">      color:#fff;</span><br><span class="line">      background-clor:rgba(0,0,0,0.5);</span><br><span class="line">      text-align:center;</span><br><span class="line">      opacity:0.8;</span><br><span class="line">      &#125;</span><br><span class="line">      .num:hover&#123;background:#000;&#125;</span><br><span class="line">      .num:hover,#photos:hover&#123;animation-play-state:paused;&#125;</span><br><span class="line">      .num:nth-child(2)&#123;margin-right:60px&#125;</span><br><span class="line">      .num:nth-child(3)&#123;margin-right:120px&#125;</span><br><span class="line">      .num:nth-child(4)&#123;margin-right:180px&#125;</span><br><span class="line">      .num:nth-child(5)&#123;margin-right:240px&#125;</span><br><span class="line">      #a1:hover ~ #photos&#123;animation: ma1 .5s ease-out forwards;&#125;</span><br><span class="line">      #a2:hover ~ #photos&#123;animation: ma2 .5s ease-out forwards;&#125;</span><br><span class="line">      #a3:hover ~ #photos&#123;animation: ma3 .5s ease-out forwards;&#125;</span><br><span class="line">      #a4:hover ~ #photos&#123;animation: ma4 .5s ease-out forwards;&#125;</span><br><span class="line">      #a5:hover ~ #photos &#123;animation: ma5 .5s ease-out forwards;&#125;</span><br><span class="line">      @keyframes ma1 &#123;0%&#123;margin-left:-1200px;&#125;100%&#123;margin-left:-0px;&#125;	&#125;</span><br><span class="line">      @keyframes ma2 &#123;0%&#123;margin-left:-1200px;&#125;100%&#123;margin-left:-1500px;&#125;	&#125;</span><br><span class="line">      @keyframes ma3 &#123;100%&#123;margin-left:-3000px;&#125;	&#125;</span><br><span class="line">      @keyframes ma4 &#123;100%&#123;margin-left:-4500px;&#125;	&#125;</span><br><span class="line">      @keyframes ma5 &#123;100%&#123;margin-left:-6000px;&#125;	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  body</span><br><span class="line">    div#navigation 欢迎访问厦门大学数据库实验室电影推荐系统</span><br><span class="line">      div#logreg</span><br><span class="line">        input(type=&#x27;submit&#x27;,value=&#x27;登录&#x27;,onclick=&quot;window.location=&#x27;/loginpage&#x27;&quot;)</span><br><span class="line">        input(type=&#x27;submit&#x27;, value=&#x27;注册&#x27;,onclick=&quot;window.location=&#x27;/registerpage&#x27;&quot;) </span><br><span class="line">    div#mid</span><br><span class="line">      #frame</span><br><span class="line">        a#a5.num 5</span><br><span class="line">        a#a4.num 4</span><br><span class="line">        a#a3.num 3</span><br><span class="line">        a#a2.num 2</span><br><span class="line">        a#a1.num 1</span><br><span class="line">        #photos.play</span><br><span class="line">          img(src=&#x27;http://img05.tooopen.com/products/20150130/44128217.jpg&#x27;)</span><br><span class="line">          img(src=&#x27;http://image.17173.com/bbs/v1/2012/11/14/1352873759491.jpg&#x27;)</span><br><span class="line">          img(src=&#x27;http://t1.27270.com/uploads/tu/201502/103/5.jpg&#x27;)</span><br><span class="line">          img(src=&#x27;http://img.doooor.com/img/forum/201507/15/171203xowepc3ju9n9br9z.jpg&#x27;)</span><br><span class="line">          img(src=&#x27;http://4493bz.1985t.com/uploads/allimg/170503/5-1F503140J0.jpg&#x27;)</span><br><span class="line">          ul#dis</span><br><span class="line">            li 魔戒：霍比特人</span><br><span class="line">            li 魔境仙踪</span><br><span class="line">            li 阿凡达</span><br><span class="line">            li 大圣归来</span><br><span class="line">            li 拆弹专家</span><br><span class="line">      </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim loginpage.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">    style.</span><br><span class="line">      body&#123;</span><br><span class="line">        background-image:url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1537261291133&amp;di=c04553d39f158272a36be6e3ec0c8071&amp;imgtype=0&amp;src=http%3A%2F%2Fh.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2Fc2fdfc039245d6885bc3be94a2c27d1ed21b2438.jpg);</span><br><span class="line">      &#125;</span><br><span class="line">      #log&#123;</span><br><span class="line">        padding-top: 2px;</span><br><span class="line">        margin-top: 10%;</span><br><span class="line">        margin-left: 37%;</span><br><span class="line">        background: white;</span><br><span class="line">        width: 25%;</span><br><span class="line">        height: 40%;</span><br><span class="line">        text-align: center;</span><br><span class="line">      &#125;</span><br><span class="line">  body</span><br><span class="line">    div#log</span><br><span class="line">      form(action=&#x27;/login&#x27;, method=&#x27;post&#x27;)</span><br><span class="line">        h1 用户登录</span><br><span class="line">        br</span><br><span class="line">        span 帐号:</span><br><span class="line">        input(type=&#x27;text&#x27;,name=&#x27;username&#x27;)</span><br><span class="line">        br</span><br><span class="line">        span 密码:</span><br><span class="line">        input(type=&#x27;password&#x27;,name=&#x27;pwd&#x27;)</span><br><span class="line">        br</span><br><span class="line">        br</span><br><span class="line">        input(type=&#x27;submit&#x27;,value=&#x27;登录&#x27;)</span><br><span class="line">        br</span><br><span class="line">        a(href=&#x27;/registerpage&#x27;, title=&#x27;注册&#x27;)注册</span><br><span class="line">        br</span><br><span class="line">        a(href=&#x27;/&#x27;,title=&#x27;主页&#x27;)返回主页</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim personalratings.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1 热烈欢迎用户: #&#123;username&#125;,请您为以下电影打分:</span><br><span class="line">    form(action=&#x27;/submituserscore&#x27;, method=&#x27;post&#x27;)</span><br><span class="line">       input(type=&#x27;text&#x27;,style=&quot;visibility: hidden;width:0px; height:0px;&quot;,name=&#x27;userid&#x27;, value=userid)</span><br><span class="line">       table( cellpadding=&quot;5&quot; cellspacing=&quot;5&quot;)</span><br><span class="line">         tr</span><br><span class="line">           -for(var i=0;i&lt;movieforpage.length;i++)</span><br><span class="line">            td</span><br><span class="line">              //p 电影名称:#&#123;movieforpage[i].moviename&#125;</span><br><span class="line">              input(type=&#x27;text&#x27;,style=&quot;visibility: hidden;width:0px; height:0px;&quot;,name=&#x27;movieid&#x27;, value=movieforpage[i].movieid)</span><br><span class="line">              img(src=movieforpage[i].picture)</span><br><span class="line">              br</span><br><span class="line">              select(name=&#x27;moviescore&#x27;)</span><br><span class="line">                option(value=1) 1</span><br><span class="line">                option(value=2) 2</span><br><span class="line">                option(value=3) 3</span><br><span class="line">                option(value=4) 4</span><br><span class="line">                option(value=5) 5</span><br><span class="line">             -if((i+1)%5==0)</span><br><span class="line">              tr</span><br><span class="line">        input(type=&#x27;submit&#x27;,value=&#x27;提交&#x27;)</span><br><span class="line">    </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim recommendresult.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1 亲爱的用户:#&#123;username&#125;,猜你喜欢电影:</span><br><span class="line">    table( cellpadding=&quot;5&quot; cellspacing=&quot;5&quot;)</span><br><span class="line">         tr</span><br><span class="line">           -for(var i=0;i&lt;movieinfo.length;i++)</span><br><span class="line">            td</span><br><span class="line">              p #&#123;movieinfo[i].moviename&#125;</span><br><span class="line">              img(src=movieinfo[i].picture)</span><br><span class="line">            -if((i+1)%5==0)</span><br><span class="line">             tr</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim registerpage.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">    style.</span><br><span class="line">      body&#123;</span><br><span class="line">        background-image:url(https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1537261291133&amp;di=c04553d39f158272a36be6e3ec0c8071&amp;imgtype=0&amp;src=http%3A%2F%2Fh.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2Fc2fdfc039245d6885bc3be94a2c27d1ed21b2438.jpg);</span><br><span class="line">      &#125;</span><br><span class="line">      #reg&#123;</span><br><span class="line">        padding-top: 2px;</span><br><span class="line">        margin-top: 10%;</span><br><span class="line">        margin-left: 37%;</span><br><span class="line">        background: white;</span><br><span class="line">        width: 25%;</span><br><span class="line">        height: 40%;</span><br><span class="line">        text-align: center;</span><br><span class="line">      &#125;</span><br><span class="line">  body</span><br><span class="line">    div#reg</span><br><span class="line">      form(action=&#x27;/register&#x27;, method=&#x27;post&#x27;)</span><br><span class="line">        h1 用户注册</span><br><span class="line">        br</span><br><span class="line">        span 帐号:</span><br><span class="line">        input(type=&#x27;text&#x27;,name=&#x27;username&#x27;)</span><br><span class="line">        br</span><br><span class="line">        span 密码:</span><br><span class="line">        input(type=&#x27;password&#x27;,name=&#x27;pwd&#x27;)</span><br><span class="line">        br</span><br><span class="line">        br</span><br><span class="line">        input(type=&#x27;submit&#x27;,value=&#x27;注册&#x27;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim registersuccess.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1 热烈欢迎用户: #&#123;message&#125;</span><br><span class="line">    a(href=&#x27;loginpage&#x27; tile=&#x27;请点击这里登录&#x27;)请点击这里登录</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>vim userscoresuccess.jade</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">html</span><br><span class="line">  head</span><br><span class="line">    title!= title</span><br><span class="line">  body</span><br><span class="line">    h1 亲爱的用户:#&#123;user.username&#125;,祝贺评分成功!</span><br><span class="line">    a(href=&#x27;/recommendmovieforuser?userid=#&#123;user.userid&#125;&amp;username=#&#123;user.username&#125;&#x27;) 点击这里为您推荐电影</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir css</span><br><span class="line">cd css</span><br><span class="line">vim index.css</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">background-image</span>:<span class="built_in">url</span>(<span class="string">https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1537261291133&amp;di=c04553d39f158272a36be6e3ec0c8071&amp;imgtype=0&amp;src=http%3A%2F%2Fh.hiphotos.baidu.com%2Fzhidao%2Fpic%2Fitem%2Fc2fdfc039245d6885bc3be94a2c27d1ed21b2438.jpg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#navigation</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#888888</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">50px</span>;  </span><br><span class="line">  <span class="attribute">margin-bottom</span>:<span class="number">5px</span>;    </span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#logreg</span>&#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">2%</span>;</span><br><span class="line">  <span class="attribute">padding-right</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#FFF</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#mid</span>&#123;</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">75%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1500px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#picchange</span>&#123;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">75%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#contain</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">margin</span>: auto;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-family</span>: Arial;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#FFF</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#contain</span> <span class="selector-tag">ul</span>&#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">1800px</span>;</span><br><span class="line">  <span class="attribute">transition</span>:all <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#contain</span> <span class="selector-tag">li</span>&#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">200px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">36px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#one</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#9fa8ef</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#two</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ef9fb1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#three</span>&#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#9fefc3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> marginLeft&#123;</span><br><span class="line">  <span class="number">0%</span>&#123;<span class="attribute">margin-left</span>: <span class="number">0</span>;&#125;</span><br><span class="line">  <span class="number">28.5%</span>&#123;<span class="attribute">margin-left</span>: <span class="number">0</span>;&#125;</span><br><span class="line">  <span class="number">33.3%</span>&#123;<span class="attribute">margin-left</span>: -<span class="number">600px</span>;&#125;</span><br><span class="line">  <span class="number">62%</span>&#123;<span class="attribute">margin-left</span>: -<span class="number">600px</span>;&#125;</span><br><span class="line">  <span class="number">66.7%</span>&#123;<span class="attribute">margin-left</span>: -<span class="number">1200px</span>;&#125;</span><br><span class="line">  <span class="number">95.2%</span>&#123;<span class="attribute">margin-left</span>: -<span class="number">1200px</span>;&#125;</span><br><span class="line">  <span class="number">100%</span>&#123;<span class="attribute">margin-left</span>: <span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#slide-auto</span>&#123;</span><br><span class="line">  <span class="attribute">animation</span>:marginLeft <span class="number">10.5s</span>infinite;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后 node js</p><p>完成</p></div><div><div><div style="text-align:center;color:#ccc;font-size:24px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div class="reward-container"><div>老板你好，讨口饭吃</div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/loading.gif" data-original="/images/wechat.jpg" alt="毛 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/loading.gif" data-original="/images/alipay.jpg" alt="毛 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>毛</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="http://example.com/2023/05/26/%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F/" title="电影推荐系统">http://example.com/2023/05/26/电影推荐系统/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Spark/" rel="tag"># Spark</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2023/05/20/queue/" rel="prev" title="queue"><i class="fa fa-chevron-left"></i> queue</a></div><div class="post-nav-item"><a href="/2023/06/01/python%E7%94%B5%E5%BD%B1/" rel="next" title="linux安装一些软件">linux安装一些软件 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments"><div id="lv-container" data-id="city" data-uid="MTAyMC81NzMzNC8zMzc5OA=="></div></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-number">1.</span> <span class="nav-text">一、创建虚拟机</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAhadoop%E7%94%A8%E6%88%B7"><span class="nav-number">1.0.0.0.1.</span> <span class="nav-text">创建一个hadoop用户</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%87%E6%8D%A2%E4%B8%8B%E8%BD%BD%E6%BA%90"><span class="nav-number">1.0.0.0.2.</span> <span class="nav-text">切换下载源</span></a></li></ol></li></ol><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85vim"><span class="nav-number">2.</span> <span class="nav-text">二、安装vim</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%AE%89%E8%A3%85JDK%E7%8E%AF%E5%A2%83"><span class="nav-number">3.</span> <span class="nav-text">三、安装JDK环境</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E4%B8%8B%E8%BD%BDHadoop"><span class="nav-number">4.</span> <span class="nav-text">四、下载Hadoop</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85ssh"><span class="nav-number">4.0.0.1.</span> <span class="nav-text">安装ssh</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85hadoop"><span class="nav-number">4.0.0.2.</span> <span class="nav-text">安装hadoop</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#core-site-xml"><span class="nav-number">4.0.0.2.1.</span> <span class="nav-text">core-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hdfs-site-xml"><span class="nav-number">4.0.0.2.2.</span> <span class="nav-text">hdfs-site.xml</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hadoop-env-sh"><span class="nav-number">4.0.0.2.3.</span> <span class="nav-text">hadoop-env.sh</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#yarn-env-sh"><span class="nav-number">4.0.0.2.4.</span> <span class="nav-text">yarn-env.sh</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mapred-site-xml%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="nav-number">4.0.0.2.5.</span> <span class="nav-text">mapred-site.xml文件配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#yarn-site-xml%E9%85%8D%E7%BD%AE"><span class="nav-number">4.0.0.2.6.</span> <span class="nav-text">yarn-site.xml配置</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8hadoop"><span class="nav-number">4.0.0.3.</span> <span class="nav-text">启动hadoop</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B0%86Hadoop%E6%B7%BB%E5%8A%A0%E5%88%B0%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E4%B8%AD"><span class="nav-number">4.0.0.3.1.</span> <span class="nav-text">将Hadoop添加到环境变量中</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%AA%8C%E8%AF%81"><span class="nav-number">4.0.0.4.</span> <span class="nav-text">验证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="nav-number">4.0.0.4.1.</span> <span class="nav-text">格式化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%90%AF%E5%8A%A8Hadoop"><span class="nav-number">4.0.0.4.2.</span> <span class="nav-text">启动Hadoop</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81HDFS%E6%93%8D%E4%BD%9C%E5%B8%B8%E7%94%A8Shell%E5%91%BD%E4%BB%A4"><span class="nav-number">5.</span> <span class="nav-text">五、HDFS操作常用Shell命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-1-%E5%90%AF%E5%8A%A8HDFS%E6%9C%8D%E5%8A%A1"><span class="nav-number">5.0.0.1.</span> <span class="nav-text">1.1 启动HDFS服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-2-help-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.2.</span> <span class="nav-text">1.2 help 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-3-ls-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.3.</span> <span class="nav-text">1.3 ls 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-4-mkdir-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.4.</span> <span class="nav-text">1.4 mkdir 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-5-put-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.5.</span> <span class="nav-text">1.5 put 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-6-cat-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.6.</span> <span class="nav-text">1.6 cat 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-7-text-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.7.</span> <span class="nav-text">1.7 text 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-8-cp-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.8.</span> <span class="nav-text">1.8 cp 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-9-mv-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.9.</span> <span class="nav-text">1.9 mv 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#1-10-rm-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.10.</span> <span class="nav-text">1.10 rm 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-1-moveFromLocal%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.11.</span> <span class="nav-text">2.1 moveFromLocal命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-2-appendToFile-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.12.</span> <span class="nav-text">2.2 appendToFile 命令</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-3-get-%E5%91%BD%E4%BB%A4"><span class="nav-number">5.0.0.13.</span> <span class="nav-text">2.3 get 命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81Spark%E4%B8%8B%E8%BD%BD"><span class="nav-number">6.</span> <span class="nav-text">六、Spark下载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E5%9C%A8spark-shell%E4%B8%AD%E8%BF%90%E8%A1%8C"><span class="nav-number">7.</span> <span class="nav-text">七、在spark-shell中运行</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AB%E3%80%81%E5%AE%89%E8%A3%85MySQL"><span class="nav-number">8.</span> <span class="nav-text">八、安装MySQL</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#mysql%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C"><span class="nav-number">8.0.1.</span> <span class="nav-text">mysql常用操作</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#1-1%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">8.0.1.0.0.1.</span> <span class="nav-text">1.1显示数据库</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-2%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E7%9A%84%E8%A1%A8"><span class="nav-number">8.0.1.0.1.</span> <span class="nav-text">2.2显示数据库中的表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-3%E6%98%BE%E7%A4%BA%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-number">8.0.1.0.2.</span> <span class="nav-text">3.3显示数据表的结构</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-4%E6%9F%A5%E8%AF%A2%E8%A1%A8%E4%B8%AD%E7%9A%84%E8%AE%B0%E5%BD%95"><span class="nav-number">8.0.1.0.3.</span> <span class="nav-text">3.4查询表中的记录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-5%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">8.0.1.0.4.</span> <span class="nav-text">3.5创建数据库</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-6%E5%88%9B%E5%BB%BA%E8%A1%A8"><span class="nav-number">8.0.1.0.5.</span> <span class="nav-text">3.6创建表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-7%E5%A2%9E%E5%8A%A0%E8%AE%B0%E5%BD%95"><span class="nav-number">8.0.1.0.6.</span> <span class="nav-text">3.7增加记录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-8%E4%BF%AE%E6%94%B9%E8%AE%B0%E5%BD%95"><span class="nav-number">8.0.1.0.7.</span> <span class="nav-text">3.8修改记录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-9%E5%88%A0%E9%99%A4%E8%AE%B0%E5%BD%95"><span class="nav-number">8.0.1.0.8.</span> <span class="nav-text">3.9删除记录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-10%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8"><span class="nav-number">8.0.1.0.9.</span> <span class="nav-text">3.10删除数据库和表</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-11%E7%9C%8Bmysql%E7%89%88%E6%9C%AC"><span class="nav-number">8.0.1.0.10.</span> <span class="nav-text">3.11看mysql版本</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B9%9D%E3%80%81Scala%E5%AE%89%E8%A3%85"><span class="nav-number">9.</span> <span class="nav-text">九、Scala安装</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E3%80%81IntelliJ-IDEA%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">10.</span> <span class="nav-text">十、IntelliJ IDEA开发工具的安装和使用方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E5%90%AF%E5%8A%A8IDEA"><span class="nav-number">11.</span> <span class="nav-text">十一、启动IDEA</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%B8%BAIDEA%E5%AE%89%E8%A3%85Scala%E6%8F%92%E4%BB%B6"><span class="nav-number">11.0.0.1.</span> <span class="nav-text">1.为IDEA安装Scala插件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AEJDK"><span class="nav-number">11.0.0.2.</span> <span class="nav-text">2.配置JDK</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%96%B0%E9%A1%B9%E7%9B%AEWordCount"><span class="nav-number">11.0.0.3.</span> <span class="nav-text">3.创建一个新项目WordCount</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E8%AE%BE%E7%BD%AE%E7%9B%AE%E5%BD%95"><span class="nav-number">11.0.0.4.</span> <span class="nav-text">4.设置目录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E9%85%8D%E7%BD%AEpom-xml%E6%96%87%E4%BB%B6"><span class="nav-number">11.0.0.5.</span> <span class="nav-text">5.配置pom.xml文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E6%89%93%E5%8C%85WordCount%E7%A8%8B%E5%BA%8F%E7%94%9F%E6%88%90JAR%E5%8C%85"><span class="nav-number">11.0.0.6.</span> <span class="nav-text">6.打包WordCount程序生成JAR包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-%E6%8A%8AJAR%E5%8C%85%E6%8F%90%E4%BA%A4%E5%88%B0Spark%E4%B8%AD%E8%BF%90%E8%A1%8C"><span class="nav-number">11.0.0.7.</span> <span class="nav-text">7.把JAR包提交到Spark中运行</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85Kettle"><span class="nav-number">12.</span> <span class="nav-text">十二、安装Kettle</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%A4%8D%E5%88%B6MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8FJAR%E5%8C%85"><span class="nav-number">12.0.0.1.</span> <span class="nav-text">1.复制MySQL数据库驱动程序JAR包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%90%AF%E5%8A%A8Kettle%E4%B8%AD%E7%9A%84Spoon"><span class="nav-number">12.0.0.2.</span> <span class="nav-text">2.启动Kettle中的Spoon</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8Kettle%E6%8A%8A%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%88%B0HDFS%E4%B8%AD"><span class="nav-number">12.0.0.3.</span> <span class="nav-text">3.使用Kettle把数据加载到HDFS中</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E4%BD%BF%E7%94%A8Spark-SQL%E8%AF%BB%E5%86%99MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E6%96%B9%E6%B3%95"><span class="nav-number">13.</span> <span class="nav-text">十三、使用Spark SQL读写MySQL数据库的方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%88%9B%E5%BB%BAMySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">13.0.0.1.</span> <span class="nav-text">1.创建MySQL数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%9C%A8spark-shell%E4%B8%AD%E8%AF%BB%E5%86%99mysql%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">13.0.0.2.</span> <span class="nav-text">2.在spark-shell中读写mysql数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%90%91MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E5%86%99%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="nav-number">13.0.0.3.</span> <span class="nav-text">3.向MySQL数据库写入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E7%BC%96%E5%86%99%E7%8B%AC%E7%AB%8B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E8%AF%BB%E5%86%99MySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">13.0.0.4.</span> <span class="nav-text">4.编写独立应用程序读写MySQL数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E7%94%9F%E6%88%90%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8FJAR%E5%8C%85"><span class="nav-number">13.0.0.5.</span> <span class="nav-text">5.生成应用程序JAR包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E6%8A%8AJAR%E5%8C%85%E6%8F%90%E4%BA%A4%E5%88%B0Spark%E4%B8%AD%E8%BF%90%E8%A1%8C"><span class="nav-number">13.0.0.6.</span> <span class="nav-text">6.把JAR包提交到Spark中运行</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81%E4%BD%BF%E7%94%A8Spark-MLlib%E5%AE%9E%E7%8E%B0%E5%8D%8F%E5%90%8C%E8%BF%87%E6%BB%A4%E7%AE%97%E6%B3%95"><span class="nav-number">14.</span> <span class="nav-text">十四、使用Spark MLlib实现协同过滤算法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%9C%A8spark-shell%E4%B8%AD%E8%BF%90%E8%A1%8CALS%E7%AE%97%E6%B3%95"><span class="nav-number">14.0.0.1.</span> <span class="nav-text">1.在spark-shell中运行ALS算法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%BC%96%E5%86%99%E7%8B%AC%E7%AB%8B%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8CALS%E7%AE%97%E6%B3%95"><span class="nav-number">14.0.0.2.</span> <span class="nav-text">2.编写独立应用程序运行ALS算法</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E4%BA%94%E3%80%81Node-js%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">15.</span> <span class="nav-text">十五、Node.js的安装和使用方法</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85"><span class="nav-number">15.0.0.0.1.</span> <span class="nav-text">1.安装</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%BA%94%E7%94%A8"><span class="nav-number">15.0.0.1.</span> <span class="nav-text">2.应用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E5%AE%89%E8%A3%85express%E5%92%8CJade"><span class="nav-number">15.0.0.2.</span> <span class="nav-text">3.安装express和Jade</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B1-%E7%99%BB%E9%99%86%E6%B3%A8%E5%86%8C"><span class="nav-number">15.0.0.3.</span> <span class="nav-text">实例1 登陆注册</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B2-%E7%94%A8jade%E5%AE%9E%E7%8E%B0"><span class="nav-number">15.0.0.4.</span> <span class="nav-text">实例2 用jade实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E7%BD%91%E9%A1%B5%E8%B0%83%E7%94%A8%E8%AF%8D%E9%A2%91%E7%BB%9F%E8%AE%A1%E7%A8%8B%E5%BA%8F"><span class="nav-number">15.0.0.5.</span> <span class="nav-text">通过网页调用词频统计程序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E5%85%AD%E3%80%81%E7%94%B5%E5%BD%B1%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F%EF%BC%88%E5%9F%BA%E7%A1%80%E7%89%88%EF%BC%89%E5%AE%9E%E7%8E%B0%E8%BF%87%E7%A8%8B"><span class="nav-number">16.</span> <span class="nav-text">十六、电影推荐系统（基础版）实现过程</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%B8%85%E6%B4%97%E6%95%B0%E6%8D%AE"><span class="nav-number">16.0.0.1.</span> <span class="nav-text">1.清洗数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%BC%96%E5%86%99Spark%E7%A8%8B%E5%BA%8F"><span class="nav-number">16.0.0.2.</span> <span class="nav-text">2.编写Spark程序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-node-js%E4%B8%AD%E5%B1%95%E7%A4%BA"><span class="nav-number">16.0.0.3.</span> <span class="nav-text">3.node.js中展示</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8D%81%E4%B8%83%E3%80%81update"><span class="nav-number">17.</span> <span class="nav-text">十七、update</span></a></li></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="毛" src="/images/xiao.png"><p class="site-author-name" itemprop="name">毛</p><div class="site-description" itemprop="description">在梦里啥都有</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">116</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">4</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">39</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/maduit" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;maduit" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:825577940@qq.com" title="E-Mail → mailto:825577940@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a> </span><span class="links-of-author-item"><a href="https://blog.csdn.net/maduit?spm=1000.2115.3001.5343" title="CSDN → https:&#x2F;&#x2F;blog.csdn.net&#x2F;maduit?spm&#x3D;1000.2115.3001.5343" rel="noopener" target="_blank"><i class="codiepie fa-fw"></i>CSDN</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-envelope fa-fw"></i> links_settings</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://github.com/" title="https:&#x2F;&#x2F;github.com&#x2F;" rel="noopener" target="_blank">推荐阅读</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; 2022-09 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">毛</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div><div class="theme-info"><div class="powered-by"></div><span class="post-count">博客全站共116.4k字</span></div><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_pv">总访问量<span id="busuanzi_value_site_pv"></span>次</span> <span class="post-meta-divider">|</span> <span id="busuanzi_container_site_uv">总访客数<span id="busuanzi_value_site_uv"></span>人</span> <span class="post-meta-divider">|</span><script>$(document).ready(function(){var e=setInterval(function(){"none"!=document.getElementById("busuanzi_container_site_pv").style.display&&($("#busuanzi_value_site_pv").html(parseInt($("#busuanzi_value_site_pv").html())+n),clearInterval(e));"none"!=$("#busuanzi_container_site_pv").css("display")&&($("#busuanzi_value_site_uv").html(parseInt($("#busuanzi_value_site_uv").html())+n),clearInterval(e))},50),n=2e4})</script><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script><script size="300" alpha="0.6" zindex="-1" src="/lib/canvas-ribbon/canvas-ribbon.js"></script><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script defer src="/lib/three/three.min.js"></script><script defer src="/lib/three/three-waves.min.js"></script><script>NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});</script><style>[bg-lazy]{background-image:none!important;background-color:#eee!important}</style><script>window.imageLazyLoadSetting={isSPA:!1,preloadRatio:1,processImages:null}</script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})})</script><script>!function(a){a.imageLazyLoadSetting.processImages=t;var e=a.imageLazyLoadSetting.isSPA,i=a.imageLazyLoadSetting.preloadRatio||1,o=r();function r(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(){e&&(o=r());for(var t,n=0;n<o.length;n++)0<=(t=o[n].getBoundingClientRect()).bottom&&0<=t.left&&t.top<=(a.innerHeight*i||document.documentElement.clientHeight*i)&&function(){var e=o[n];!function(t,e){if(t.hasAttribute("bg-lazy"))return t.removeAttribute("bg-lazy"),e();var n=new Image,a=t.getAttribute("data-original");n.onload=function(){t.src=a,t.removeAttribute("data-original"),e()},t.src!==a&&(n.src=a)}(e,function(){o=o.filter(function(t){return e!==t}),a.imageLazyLoadSetting.onImageLoaded&&a.imageLazyLoadSetting.onImageLoaded(e)})}()}function n(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",n),a.addEventListener("resize",n),a.addEventListener("orientationchange",n)}(this)</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({model:{jsonPath:"/live2dw/assets/koharu.model.json"},display:{position:"right",width:150,height:300},mobile:{show:!1},log:!1,pluginJsPath:"lib/",pluginModelPath:"assets/",pluginRootPath:"live2dw/",tagMode:!1})</script></body></html><script type="text/javascript" src="/js/love.js"></script><canvas class="fireworks" style="position:fixed;left:0;top:0;z-index:1;pointer-events:none"></canvas><script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script><script type="text/javascript" src="/js/fireworks.js"></script><script type="text/javascript" src="\js\snow.js"></script><script type="text/javascript" src="http://libs.baidu.com/jquery/1.8.3/jquery.js"></script><script type="text/javascript" src="http://libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>